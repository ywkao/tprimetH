#!/usr/bin/env python
import subprocess
import ctypes
import array
import math
import ROOT
ROOT.gROOT.SetBatch(True)

from plot_utils import *

do_individual=True
do_individual=False

path = "/afs/cern.ch/user/y/ykao/work/tPrimeExcessHgg/CMSSW_10_6_8/src/tprimetH/"
dir_output = path + "study_HT_issue/EOS_output_ht"
rootfile = path + "plots/myhist_combine_RunII.root"
rootfile = path + "shortcut_plots/plots_20211221/myhist_combine_RunII.root"
fin = ROOT.TFile.Open(rootfile, "R")

ROOT.gStyle.SetOptStat("e")
ROOT.gStyle.SetOptFit(1111)

v_hist_collector, v_herrs_collector = [], []

myLabel = {
    "QCD_GammaJets_imputed" : "Data-driven (#gamma)+jets",
    "QCD": "MC (#gamma)+jets",
    #"QCD": "MC QCD",
    "GammaJets" : "MC #gamma+jets",
}

# canvas & pads {{{
c1 = ROOT.TCanvas("c1", "", 800, 600)
c1.SetGrid()
c1.SetTicks(1,1)
c1.SetLeftMargin(0.12)
c1.SetRightMargin(0.08)

c2 = ROOT.TCanvas("c2", "", 1200, 600)
c2.SetGrid()
c2.SetTicks(1,1)
c2.SetLeftMargin(0.12)
c2.SetRightMargin(0.08)

#pad1 = ROOT.TPad("pad1", "", 0, 0.3, 1, 1)
#pad2 = ROOT.TPad("pad2", "", 0, 0, 1, 0.3)
#}}}
# setup {{{
d_fit_const = {"central":[], "error":[]}
d_fit_mean  = {"central":[], "error":[]}
d_fit_sigma = {"central":[], "error":[]}

#--------------------------------------------------

masses = [600, 625, 650, 675, 700, 800, 900, 1000, 1100, 1200]
masses_v2 = [600, 625, 650, 675, 700, 750, 800, 850, 900, 950, 1000, 1050, 1100, 1150, 1200]
mass_M600_M700 = [600, 625, 650, 675, 700]
mass_M800_M1000 = [800, 900, 1000]
mass_M1100_M1200 = [1100, 1200]

ytitles = {
    "yields": {
        "hHT":"Yields / 20 GeV",
        "hJet1pT":"Yields / 20 GeV",
        "hJet2pT":"Yields / 20 GeV",
        "hJet3pT":"Yields / 20 GeV",
        "hJet4pT":"Yields / 20 GeV",
        "hjet1_ptOverM":"Yields / 0.5",
        "hjet2_ptOverM":"Yields / 0.5",
        "hjet3_ptOverM":"Yields / 0.5",
        "hjet4_ptOverM":"Yields / 0.5",
        "hMass_fine":"Yields / 0.5 GeV",
        "hMass_pass_BDTG_smh_cut_mixed03_fine":"Yields / 0.5 GeV",
        "hMass_pass_BDTG_smh_cut_mixed04_fine":"Yields / 0.5 GeV",
        "hMass_pass_BDTG_smh_cut_mixed05_fine":"Yields / 0.5 GeV",
        "hmass_tprime_cov_fine":"Yields / 5 GeV",
        "hTprime_Mass_pass_BDTG_smh_cut_mixed03_SR_fine":"Yields / 5 GeV",
        "hTprime_Mass_pass_BDTG_smh_cut_mixed04_SR_fine":"Yields / 5 GeV",
        "hTprime_Mass_pass_BDTG_smh_cut_mixed05_SR_fine":"Yields / 5 GeV",
    },
    "normalized": {
        "hHT":"Arbitrary unit / 20 GeV",
        "hJet1pT":"Arbitrary unit / 20 GeV",
        "hJet2pT":"Arbitrary unit / 20 GeV",
        "hJet3pT":"Arbitrary unit / 20 GeV",
        "hJet4pT":"Arbitrary unit / 20 GeV",
        "hjet1_ptOverM":"Arbitrary unit / 0.5",
        "hjet2_ptOverM":"Arbitrary unit / 0.5",
        "hjet3_ptOverM":"Arbitrary unit / 0.5",
        "hjet4_ptOverM":"Arbitrary unit / 0.5",
        "hMass_fine":"Arbitrary unit / 0.5 GeV",
        "hMass_pass_BDTG_smh_cut_mixed03_fine":"Arbitrary unit / 0.5 GeV",
        "hMass_pass_BDTG_smh_cut_mixed04_fine":"Arbitrary unit / 0.5 GeV",
        "hMass_pass_BDTG_smh_cut_mixed05_fine":"Arbitrary unit / 0.5 GeV",
        "hmass_tprime_cov_fine":"Arbitrary unit / 5 GeV",
        "hTprime_Mass_pass_BDTG_smh_cut_mixed03_SR_fine":"Arbitrary unit / 5 GeV",
        "hTprime_Mass_pass_BDTG_smh_cut_mixed04_SR_fine":"Arbitrary unit / 5 GeV",
        "hTprime_Mass_pass_BDTG_smh_cut_mixed05_SR_fine":"Arbitrary unit / 5 GeV",
    },
}

xtitles = {
    "hHT":"H_{T} [GeV]",
    "hJet1pT":"Jet1 p_{T} [GeV]",
    "hJet2pT":"Jet2 p_{T} [GeV]",
    "hJet3pT":"Jet3 p_{T} [GeV]",
    "hJet4pT":"Jet4 p_{T} [GeV]",
    "hjet1_ptOverM":"Jet1 p_{T} / M_{top}",
    "hjet2_ptOverM":"Jet2 p_{T} / M_{top}",
    "hjet3_ptOverM":"Jet3 p_{T} / M_{top}",
    "hjet4_ptOverM":"Jet4 p_{T} / M_{top}",
    "hMass_fine":"M_{#gamma#gamma} (GeV)",
    "hMass_pass_BDTG_smh_cut_mixed03_fine":"M_{#gamma#gamma} (GeV)",
    "hMass_pass_BDTG_smh_cut_mixed04_fine":"M_{#gamma#gamma} (GeV)",
    "hMass_pass_BDTG_smh_cut_mixed05_fine":"M_{#gamma#gamma} (GeV)",
    "hmass_tprime_cov_fine":"M_{bjj#gamma#gamma} (GeV)",
    "hTprime_Mass_pass_BDTG_smh_cut_mixed03_SR_fine":"M_{bjj#gamma#gamma} (GeV)",
    "hTprime_Mass_pass_BDTG_smh_cut_mixed04_SR_fine":"M_{bjj#gamma#gamma} (GeV)",
    "hTprime_Mass_pass_BDTG_smh_cut_mixed05_SR_fine":"M_{bjj#gamma#gamma} (GeV)",
}

v_set1 = {
    #600  : ROOT.kMagenta,
    #625  : ROOT.kMagenta+2,
    600  : ROOT.kRed-9,
    625  : ROOT.kRed-7,
    650  : ROOT.kRed,
    675  : ROOT.kRed+2,
    700  : ROOT.kRed+4,
    800  : ROOT.kGreen-5,
    900  : ROOT.kGreen+1,
    1000 : ROOT.kGreen+3,
    1100 : ROOT.kBlue,
    1200 : ROOT.kBlue+2,
}

v_set2 = {
    600  : ROOT.kOrange,
    625  : ROOT.kOrange+2,
    650  : ROOT.kRed,
    675  : ROOT.kRed+3,
    700  : ROOT.kBlack,
    800  : ROOT.kGreen+1,
    900  : ROOT.kGreen+3,
    1000 : ROOT.kCyan,
    1100 : ROOT.kBlue,
    1200 : ROOT.kBlue+2,
}

v_blue = {
    600  : ROOT.kBlue-10,
    625  : ROOT.kBlue-9,
    650  : ROOT.kBlue-7,
    675  : ROOT.kBlue-4,
    700  : ROOT.kBlue,
    800  : ROOT.kBlue+1,
    900  : ROOT.kBlue+2,
    1000 : ROOT.kBlue+3,
    1100 : ROOT.kBlue+4,
    1200 : ROOT.kBlack
}

v_red = {
    600  : ROOT.kRed-10,
    625  : ROOT.kRed-9,
    650  : ROOT.kRed-7,
    675  : ROOT.kRed-4,
    700  : ROOT.kRed,
    800  : ROOT.kRed+1,
    900  : ROOT.kRed+2,
    1000 : ROOT.kRed+3,
    1100 : ROOT.kRed+4,
    1200 : ROOT.kBlack
}

default_color_scheme = {
    #"QCD_GammaJets_imputed" : ROOT.kBlue-7,
    #"GammaJets"             : ROOT.kRed+3,
    "Data"                  : ROOT.kBlack,
    "QCD_GammaJets_imputed" : ROOT.kOrange+6,
    "QCD"                   : ROOT.kOrange+6,
    #"QCD"                   : ROOT.kRed+1,
    "GammaJets"             : ROOT.kRed+3,
    "DiPhoton"              : ROOT.kRed+1,
    "TTGG"                  : ROOT.kGreen-2,
    "TTGJets"               : ROOT.kGreen-7,
    "TTJets"                : ROOT.kSpring+10,
    "VG"                    : ROOT.kViolet-9,
    "DY"                    : ROOT.kCyan-7,
    "GammaJets_Madgraph"    : ROOT.kRed,
    "WJets"                 : ROOT.kBlue+2,
    "TGamma"                : ROOT.kYellow-9,
    "TTZ"                   : ROOT.kAzure+1,
    "TTW"                   : ROOT.kRed,
    "tV"                    : ROOT.kPink-6,
    "VV"                    : ROOT.kPink+6,
    "ttH"                   : ROOT.kCyan-9
}

colors = {
    "hMass_fine":v_set1,
    "hMass_pass_BDTG_smh_cut_mixed03_fine":v_set1,
    "hMass_pass_BDTG_smh_cut_mixed04_fine":v_set1,
    "hMass_pass_BDTG_smh_cut_mixed05_fine":v_set1,
    "hmass_tprime_cov_fine":v_set1,
    "hTprime_Mass_pass_BDTG_smh_cut_mixed03_SR_fine":v_set1,
    "hTprime_Mass_pass_BDTG_smh_cut_mixed04_SR_fine":v_set1,
    "hTprime_Mass_pass_BDTG_smh_cut_mixed05_SR_fine":v_set1,
    "collective":v_set2,
    "hHT":default_color_scheme,
    "hJet1pT":default_color_scheme,
    "hJet2pT":default_color_scheme,
    "hJet3pT":default_color_scheme,
    "hJet4pT":default_color_scheme,
    "hjet1_ptOverM":default_color_scheme,
    "hjet2_ptOverM":default_color_scheme,
    "hjet3_ptOverM":default_color_scheme,
    "hjet4_ptOverM":default_color_scheme,
    #"hMass_fine":v_blue,
    #"hMass_pass_BDTG_smh_cut_mixed03_fine":v_blue,
    #"hMass_pass_BDTG_smh_cut_mixed04_fine":v_blue,
    #"hMass_pass_BDTG_smh_cut_mixed05_fine":v_blue,
    #"hmass_tprime_cov_fine":v_red,
    #"hTprime_Mass_pass_BDTG_smh_cut_mixed03_SR_fine":v_red,
    #"hTprime_Mass_pass_BDTG_smh_cut_mixed04_SR_fine":v_red,
    #"hTprime_Mass_pass_BDTG_smh_cut_mixed05_SR_fine":v_red,
}

ranges = {
    "hHT":[0,1000],
    "hJet1pT":[0,500],
    "hJet2pT":[0,500],
    "hJet3pT":[0,500],
    "hJet4pT":[0,500],
    "hjet1_ptOverM":[0,10.],
    "hjet2_ptOverM":[0,10.],
    "hjet3_ptOverM":[0,10.],
    "hjet4_ptOverM":[0,10.],
    "hMass_fine":[100,180],
    "hMass_pass_BDTG_smh_cut_mixed03_fine":[100,180],
    "hMass_pass_BDTG_smh_cut_mixed04_fine":[100,180],
    "hMass_pass_BDTG_smh_cut_mixed05_fine":[100,180],
    "hmass_tprime_cov_fine":[200,2500],
    "hTprime_Mass_pass_BDTG_smh_cut_mixed03_SR_fine":[480,800],
    "hTprime_Mass_pass_BDTG_smh_cut_mixed04_SR_fine":[630,1150],
    "hTprime_Mass_pass_BDTG_smh_cut_mixed05_SR_fine":[750,1600],
    "fullTprime":[350, 1650],
    #"fullTprime":[450, 1650],
}

leg_pos_set1 = {
    # key = number of mass points to be ploted in a figure
    10 : [0.58, 0.25, 0.85, 0.85],
    5  : [0.58, 0.55, 0.85, 0.85],
    3  : [0.58, 0.67, 0.85, 0.85],
    2  : [0.58, 0.73, 0.85, 0.85],
}

leg_pos_set2 = {
    # key = number of mass points to be ploted in a figure
    10 : [0.58, 0.25, 0.85, 0.85],
    3  : [0.58, 0.67, 0.85, 0.85],
    2  : [0.58, 0.73, 0.85, 0.85],
    5  : [0.12, 0.55, 0.30, 0.85],
}

leg_pos_set3 = [0.15, 0.75, 0.35, 0.87]
leg_pos_set4 = [0.17, 0.45, 0.35, 0.57]
leg_pos_set5 = [0.57, 0.20, 0.87, 0.35]

legend_position = {
    "hHT":leg_pos_set1,
    "hJet1pT":leg_pos_set1,
    "hJet2pT":leg_pos_set1,
    "hJet3pT":leg_pos_set1,
    "hJet4pT":leg_pos_set1,
    "hjet1_ptOverM":leg_pos_set1,
    "hjet2_ptOverM":leg_pos_set1,
    "hjet3_ptOverM":leg_pos_set1,
    "hjet4_ptOverM":leg_pos_set1,
    "hMass_fine":leg_pos_set1,
    "hMass_pass_BDTG_smh_cut_mixed03_fine":leg_pos_set1,
    "hMass_pass_BDTG_smh_cut_mixed04_fine":leg_pos_set1,
    "hMass_pass_BDTG_smh_cut_mixed05_fine":leg_pos_set1,
    "hmass_tprime_cov_fine":leg_pos_set2,
    "hTprime_Mass_pass_BDTG_smh_cut_mixed03_SR_fine":leg_pos_set2,
    "hTprime_Mass_pass_BDTG_smh_cut_mixed04_SR_fine":leg_pos_set2,
    "hTprime_Mass_pass_BDTG_smh_cut_mixed05_SR_fine":leg_pos_set2,
    # individual plot with fit
    "tprime":leg_pos_set5,
    600 :leg_pos_set3,
    625 :leg_pos_set3,
    650 :leg_pos_set3,
    675 :leg_pos_set4,
    700 :leg_pos_set4,
    800 :leg_pos_set3,
    900 :leg_pos_set3,
    1000:leg_pos_set4,
    1100:leg_pos_set3,
    1200:leg_pos_set3,
}

stat_pos_set1 = [0.89, 0.87, 0.20, 0.20]
stat_pos_set2 = [0.89, 0.87, 0.15, 0.15]
stat_pos_set3 = [0.43, 0.87, 0.15, 0.15]
stat_position = {
    "hHT":stat_pos_set1,
    "hMass_fine":stat_pos_set1,
    "hMass_pass_BDTG_smh_cut_mixed03_fine":stat_pos_set1,
    "hMass_pass_BDTG_smh_cut_mixed04_fine":stat_pos_set1,
    "hMass_pass_BDTG_smh_cut_mixed05_fine":stat_pos_set1,
    "hmass_tprime_cov_fine":stat_pos_set1,
    600 :stat_pos_set2,
    625 :stat_pos_set2,
    650 :stat_pos_set2,
    675 :stat_pos_set3,
    700 :stat_pos_set3,
    800 :stat_pos_set2,
    900 :stat_pos_set2,
    1000:stat_pos_set3,
    1100:stat_pos_set2,
    1200:stat_pos_set2,
    #"hTprime_Mass_pass_BDTG_smh_cut_mixed03_SR_fine":stat_pos_set2,
    #"hTprime_Mass_pass_BDTG_smh_cut_mixed04_SR_fine":stat_pos_set2,
    #"hTprime_Mass_pass_BDTG_smh_cut_mixed05_SR_fine":stat_pos_set2,
}

fit_ranges = {
    # for fit summary
    "mgg"   :{ "range":[122., 128.] , "mean" :[123.5, 125.5], "sigma":[1.0, 1.8] },
    "tprime":{ "range":[500., 1300.], "mean" :[500., 1300.] , "sigma":[0., 80.] },

    # for individual fit
    600 :{ "range":[550. ,650.]  },
    625 :{ "range":[575. ,675.]  },
    650 :{ "range":[600. ,700.]  },
    675 :{ "range":[625. ,725.]  },
    700 :{ "range":[650. ,750.]  },
    800 :{ "range":[740. ,860.]  },
    900 :{ "range":[840. ,960.]  },
    1000:{ "range":[940. ,1060.] },
    1100:{ "range":[1020.,1180.] },
    1200:{ "range":[1120.,1280.] },

    #600 :{ "range":[540. ,660.]  },
    #625 :{ "range":[565. ,685.]  },
    #650 :{ "range":[590. ,710.]  },
    #675 :{ "range":[615. ,735.]  },
    #700 :{ "range":[640. ,760.]  },
    #800 :{ "range":[720. ,880.]  },
    #900 :{ "range":[820. ,980.]  },
    #1000:{ "range":[920. ,1080.] },
    #1100:{ "range":[1020.,1180.] },
    #1200:{ "range":[1120.,1280.] },
}

fit_ytitles = {
    "mgg":{
        "range":"Mean and sigma of m(#gamma#gamma) from Gaussian fit",
        "mean" :"Mean of m(#gamma#gamma) from Gaussian fit",
        "sigma":"Sigma of m(#gamma#gamma) from Gaussian fit",
    },
    "tprime":{
        "range":"Mean and sigma of M_{bjj#gamma#gamma} from Gaussian fit",
        "mean" :"Mean of M_{bjj#gamma#gamma} from Gaussian fit",
        "sigma":"Sigma of M_{bjj#gamma#gamma} from Gaussian fit",
    },
}

labels = {
    "Data": "Data",
    "DiPhoton": "#gamma#gamma + Jets",
    "GammaJets": "#gamma + Jets",
    "QCD": "QCD",
    "TTGG": "t#bar{t} + #gamma#gamma",
    "TTGJets": "t#bar{t} + #gamma",
    "VG": "V + #gamma",
    "WJets": "W+Jets",
    "TTJets": "t#bar{t} + Jets", 
    "THQ": "tHq",
    "ggH": "ggH",
    "VH": "VH",
    "VBF": "VBF",
    "TGamma": "t+#gamma+Jets",
    "QCD_GammaJets_imputed": "(#gamma) + Jets",
    "TTZ": "t#bar{tZ}",
    "TTW": "t#bar{tW}",
    "VV": "VV",
    "tV": "t + V",
    "ttH": "t#bar{tH}(125)",
    "TT_FCNC_hut": "t#bar{t} FCNC (Hut)",
    "TT_FCNC_hct": "t#bar{t} FCNC (Hct)",
    "ST_FCNC_hut": "t FCNC (Hut)",
    "ST_FCNC_hct": "t FCNC (Hct)",
    "TprimeBToTH_M-600" : "T'(600)",
    "TprimeBToTH_M-625" : "T'(625)",
    "TprimeBToTH_M-650" : "T'(650)",
    "TprimeBToTH_M-675" : "T'(675)",
    "TprimeBToTH_M-700" : "T'(700)",
    "TprimeBToTH_M-800" : "T'(800)",
    "TprimeBToTH_M-900" : "T'(900)",
    "TprimeBToTH_M-1000": "T'(1000)",
    "TprimeBToTH_M-1100": "T'(1100)",
    "TprimeBToTH_M-1200": "T'(1200)"
}
#}}}
def create_pad(): #{{{
    pad1.SetTicks(1,1)
    pad1.SetGrid(1,1)
    pad1.SetTopMargin(0.10);
    pad1.SetBottomMargin(0.02);
    pad1.SetRightMargin(0.07);
    pad1.SetLeftMargin(0.12);
    pad1.Draw()

    c1.cd()
    pad2.SetTicks(1,1)
    pad2.SetGrid(1,1)
    pad2.SetTopMargin(0.07);
    pad2.SetBottomMargin(0.36);
    pad2.SetRightMargin(0.07);
    pad2.SetLeftMargin(0.12);
    pad2.Draw()
#}}}

def make_composition(): #{{{
    c1.cd()
    backgrounds = "DiPhoton|QCD_GammaJets_imputed|TTGG|TTGJets|TTJets|VG"
    processes = backgrounds.split('|')
    raw_values_n50 = { #{{{
        "Data": [14690.00, 85142.00, 38380.00, 14642.00, 6050.00, 2925.00, 1557.00, 833.00, 511.00, 290.00, 198.00, 117.00, 84.00, 55.00, 32.00, 26.00, 15.00, 14.00, 5.00, 5.00, 6.00, 2.00, 4.00, 1.00, 1.00, 2.00, 0.00, 0.00, 0.00, 1.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "DiPhoton"       : [2797.85, 22667.67, 12055.98, 5436.62, 2796.55, 1578.45, 911.29, 564.15, 357.59, 238.55, 155.99, 114.38, 82.10, 57.60, 42.32, 31.51, 24.55, 20.53, 12.14, 10.88, 5.58, 5.70, 4.75, 3.83, 2.48, 2.22, 0.89, 2.25, 1.27, 1.27, 1.64, 1.21, 0.47, 0.28, 0.53, 0.27, 0.56, 0.18, 0.39, 0.12, 0.41, 0.23, 0.13, 0.04, 0.03, 0.01, 0.06, 0.00, 0.03, 0.00, 0.06],
        "QCD_GammaJets_imputed": [9889.18, 58529.73, 25861.61, 9781.38, 4089.47, 1733.56, 950.89, 470.45, 268.22, 163.90, 126.47, 66.38, 47.70, 31.34, 18.60, 15.48, 9.39, 6.45, 3.87, 3.28, 0.99, 1.72, 0.00, 0.00, 3.22, 0.62, 1.67, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "TTGG"           : [-0.69, 29.69, 90.66, 104.93, 70.36, 27.84, 40.26, 24.28, 8.36, 9.05, 9.25, 5.42, 4.42, 3.84, -0.19, 1.24, -0.10, 0.43, 0.18, 0.25, 0.01, 0.48, 0.18, 0.04, 0.23, 0.27, 0.02, -0.00, 0.08, 0.00, -0.00, 0.01, 0.00, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "TTGJets"        : [10.62, 267.89, 306.58, 251.32, 102.71, 74.49, 29.45, 40.34, 21.49, 26.87, 4.90, 3.87, 3.04, -2.78, 0.45, 0.66, -0.19, 1.08, 0.29, -1.63, 0.38, -0.13, 0.18, 0.24, 0.21, 0.08, 0.00, 0.00, 0.09, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "TTJets"         : [3.42, 274.87, 296.71, 196.92, 38.63, 19.69, 6.31, 18.23, 1.43, 2.19, 2.84, 1.27, 3.15, -0.32, 1.80, 0.00, 0.00, 1.90, 1.25, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "VG"             : [74.12, 390.78, 235.17, 153.41, 69.34, 67.45, 17.83, 20.05, 5.87, 2.44, 4.24, 0.70, 2.02, 1.78, 0.36, 0.00, 0.00, 1.16, 0.00, 0.00, 0.00, 0.00, 0.09, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
    } #}}}
    raw_values_n250 = { #{{{
        "Data": [0.00, 0.00, 0.00, 594.00, 14096.00, 18898.00, 19738.00, 17763.00, 15612.00, 13131.00, 10960.00, 9004.00, 7460.00, 5963.00, 4993.00, 4051.00, 3404.00, 2845.00, 2389.00, 1953.00, 1641.00, 1371.00, 1188.00, 1032.00, 818.00, 734.00, 713.00, 537.00, 505.00, 436.00, 396.00, 340.00, 317.00, 283.00, 221.00, 216.00, 174.00, 163.00, 151.00, 129.00, 118.00, 109.00, 104.00, 89.00, 91.00, 69.00, 55.00, 59.00, 59.00, 48.00, 41.00, 53.00, 34.00, 54.00, 16.00, 30.00, 24.00, 23.00, 20.00, 20.00, 25.00, 18.00, 11.00, 21.00, 9.00, 12.00, 14.00, 12.00, 11.00, 6.00, 9.00, 7.00, 7.00, 3.00, 6.00, 2.00, 6.00, 7.00, 7.00, 4.00, 1.00, 5.00, 5.00, 2.00, 2.00, 4.00, 4.00, 4.00, 1.00, 1.00, 1.00, 2.00, 1.00, 1.00, 0.00, 1.00, 0.00, 3.00, 1.00, 0.00, 1.00, 1.00, 0.00, 3.00, 1.00, 0.00, 0.00, 0.00, 2.00, 0.00, 0.00, 0.00, 1.00, 3.00, 0.00, 1.00, 0.00, 0.00, 0.00, 0.00, 1.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.00, 0.00, 1.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "DiPhoton": [0.00, 0.00, 0.00, 96.12, 2701.73, 4462.91, 5084.38, 4918.30, 4401.43, 3800.65, 3282.06, 2793.47, 2321.73, 1992.01, 1666.71, 1444.04, 1244.94, 1047.21, 911.42, 789.01, 700.12, 629.41, 557.94, 479.00, 430.09, 382.27, 356.37, 304.89, 288.05, 246.88, 218.20, 195.50, 184.58, 161.94, 151.07, 134.83, 127.10, 110.16, 96.38, 95.69, 87.74, 77.03, 67.84, 66.99, 57.98, 54.78, 51.75, 48.93, 42.23, 40.85, 36.42, 34.48, 33.29, 27.26, 24.54, 26.98, 24.30, 21.19, 24.27, 17.64, 17.87, 18.57, 17.60, 14.45, 13.61, 11.05, 11.57, 12.98, 10.50, 11.50, 9.39, 8.35, 7.73, 9.28, 7.57, 7.45, 8.12, 6.25, 5.19, 4.50, 4.75, 4.53, 7.29, 3.76, 4.22, 3.81, 4.47, 3.56, 3.97, 4.72, 4.05, 2.17, 2.04, 2.29, 1.59, 2.63, 2.31, 1.63, 2.30, 2.01, 1.38, 1.16, 1.03, 1.19, 0.80, 0.65, 1.54, 0.94, 0.60, 1.96, 0.82, 1.28, 0.93, 0.71, 1.01, 0.88, 0.54, 0.64, 1.31, 0.45, 0.46, 0.57, 0.46, 0.35, 0.64, 0.12, 0.48, 0.22, 0.27, 1.13, 0.09, 0.25, 0.09, 0.06, 0.40, 0.71, 0.25, 0.46, 0.48, 0.35, 0.70, 0.25, 0.10, 0.00, 0.22, 0.03, 0.71, 0.12, 0.30, 0.10, 0.32, 0.02, 0.18, 0.66, 0.46, 0.08, 0.38, 0.14, 0.36, 0.25, 0.05, 0.07, 0.27, 0.00, 0.07, 0.02, 0.03, 0.23, 0.00, 0.00, 0.41, 0.00, 0.00, 0.09, 0.03, 0.13, 0.00, 0.11, 0.03, 0.00, 0.49, 0.00, 0.00, 0.00, 0.06, 0.10, 0.00, 0.00, 0.08, 0.00, 0.02, 0.00, 0.34, 0.03, 0.00, 0.00, 0.12, 0.00, 0.00, 0.00, 0.18, 0.00, 0.00, 0.23, 0.00, 0.03, 0.20, 0.00, 0.00, 0.00, 0.00, 0.00, 0.08, 0.04, 0.00, 0.00, 0.00, 0.02, 0.00, 0.02, 0.00, 0.00, 0.00, 0.03, 0.00, 0.01, 0.00, 0.00, 0.00, 0.00, 0.06, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.03, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.06],
        "QCD_GammaJets_imputed": [0.00, 0.00, 0.00, 347.93, 9541.25, 12877.45, 13329.05, 12486.81, 10473.64, 9362.79, 7297.64, 6120.98, 4876.88, 4141.55, 3424.56, 2731.61, 2287.12, 1876.20, 1580.28, 1306.17, 1088.60, 881.92, 887.66, 640.69, 590.60, 489.49, 358.06, 342.68, 301.45, 241.87, 243.39, 220.64, 189.41, 153.08, 144.38, 105.08, 117.25, 82.85, 87.43, 77.83, 76.33, 60.33, 43.83, 45.50, 42.23, 44.76, 43.42, 31.65, 21.83, 22.25, 19.97, 24.74, 29.03, 23.64, 29.08, 12.94, 20.37, 11.13, 14.02, 7.92, 11.53, 9.76, 7.55, 7.88, 10.98, 12.95, 5.54, 4.33, 3.64, 4.88, 9.76, 0.00, 2.98, 1.59, 4.27, 3.16, 0.00, 3.36, 5.79, 3.17, 5.94, 1.68, 0.00, 0.00, 1.77, 1.69, 0.00, 3.06, 1.70, 0.00, 2.16, 0.00, 0.00, 1.71, 0.00, 1.69, 0.00, 0.00, 0.00, 1.59, 0.00, 0.00, 0.99, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.72, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.50, 0.00, 1.72, 0.00, 0.00, 0.62, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.67, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "TTGG": [0.00, 0.00, 0.00, 0.08, -0.77, 4.69, 5.37, 2.36, 7.21, 10.06, 24.35, 22.74, 12.49, 14.91, 16.16, 23.20, 19.92, 12.40, 23.29, 26.12, 18.65, 18.30, 6.07, 15.96, 11.38, -0.07, 8.47, 6.72, 8.17, 4.55, 6.74, 14.11, 7.34, 4.67, 7.39, 4.23, 7.26, 5.93, 3.70, 3.16, 1.16, 2.86, 1.59, 1.47, 1.28, 1.21, 0.97, 1.96, 1.33, 3.57, 4.20, 0.02, 0.44, 0.87, 3.72, -0.06, 3.30, 0.85, 1.29, 0.05, 2.86, 0.57, 0.19, -0.13, 0.93, 0.20, 0.09, 3.19, 0.18, 0.17, 0.35, -0.82, 0.14, 0.07, 0.07, 0.17, 0.08, 0.61, 0.39, -0.01, 0.03, -0.18, 0.05, -0.01, 0.02, 0.08, -0.02, 0.32, -0.04, 0.10, 0.01, -0.00, 0.01, 0.14, 0.02, 0.01, 0.01, -0.00, 0.02, 0.22, -0.01, -0.00, 0.01, 0.00, 0.01, 0.01, 0.01, 0.32, 0.01, 0.13, 0.01, 0.15, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.22, -0.00, 0.00, 0.00, 0.00, 0.13, 0.00, 0.00, 0.14, 0.00, -0.00, 0.00, 0.01, 0.01, 0.01, 0.00, 0.00, 0.00, -0.01, -0.00, -0.00, 0.09, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 0.00, 0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "TTGJets": [0.00, 0.00, 0.00, 0.16, 10.46, 24.30, 30.34, 55.71, 74.55, 82.98, 91.45, 64.26, 62.30, 65.56, 23.01, 74.29, 51.82, 40.87, 35.64, 48.71, 37.84, 4.87, 21.29, 29.62, 9.10, 15.16, 27.15, 9.13, 9.67, 13.38, 11.49, 0.50, 1.68, 8.09, 7.69, 6.32, 12.85, 4.50, 9.13, 7.54, 9.47, 6.07, 5.05, 1.48, -0.58, 5.36, 11.44, 0.73, 8.17, 1.17, 1.37, 1.01, 0.25, 2.18, 0.09, 0.89, 0.34, -0.02, 0.52, 2.13, 0.57, 0.72, -0.10, -0.23, 2.08, 0.14, -4.28, 1.16, -0.29, 0.49, 0.35, -0.07, 0.01, 0.20, -0.05, 0.33, 0.06, 0.00, 0.02, 0.26, 0.18, 0.01, -0.07, -0.03, -0.29, 0.00, 0.28, -0.00, 0.58, 0.22, 0.00, -0.00, 0.00, 0.29, 0.00, -0.00, -0.00, 0.00, 0.17, -1.79, 0.00, 0.14, 0.24, 0.00, -0.00, 0.00, 0.00, -0.14, 0.00, 0.00, 0.00, 0.18, 0.00, 0.00, 0.00, 0.00, 0.09, 0.15, 0.00, 0.00, 0.00, 0.21, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 0.00, 0.08, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.04, 0.00, 0.14, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "TTJets": [0.00, 0.00, 0.00, 0.00, 3.42, 29.76, 55.87, 46.15, 76.47, 66.61, 92.57, 68.45, 107.78, 19.56, 8.35, 35.27, 51.51, 30.46, 49.35, 30.32, -22.91, 11.33, 18.79, 9.53, 21.89, 2.97, 4.12, 11.36, -1.12, 2.37, -2.56, 3.11, 1.04, -1.34, 6.07, 4.24, 9.83, 1.19, 1.68, 1.28, 2.00, 1.18, -1.86, 0.11, -0.01, -0.00, 0.70, 0.38, 0.54, 0.57, 0.25, 1.12, 1.46, 0.01, 0.00, 1.24, -0.00, 0.04, 0.00, 0.00, 0.72, 0.00, 1.19, 1.33, -0.09, -0.32, 0.00, 0.00, 0.00, 0.00, 1.88, -0.07, 0.00, 0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.90, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.25, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "VG": [0.00, 0.00, 0.00, 1.10, 73.02, 88.58, 72.35, 83.64, 80.08, 66.15, 69.47, 43.00, 49.84, 59.18, 13.68, 43.24, 49.76, 20.35, 24.24, 15.82, 26.99, 6.61, 7.94, 20.43, 7.37, 24.79, 16.35, 4.68, 2.22, 19.42, 3.10, 3.25, 3.64, 4.29, 3.55, 0.82, 13.13, 1.59, 0.79, 3.72, 1.48, 1.16, 0.68, 1.80, 0.75, 0.00, -0.96, 3.04, -0.59, 0.95, 3.30, 0.00, 0.00, 0.00, 0.93, 0.13, 0.57, 0.00, 0.00, 0.00, 0.00, 0.38, -0.27, 1.91, 0.00, 0.00, 0.56, 0.00, 1.22, 0.00, 0.00, 0.00, 0.36, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.31, 0.00, 0.00, 0.85, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.09, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
    } #}}}
    raw_vales_error_n250 = { #{{{
        "Data"                  : [0.00, 0.00, 0.00, 24.37, 118.73, 137.47, 140.49, 133.28, 124.95, 114.59, 104.69, 94.89, 86.37, 77.22, 70.66, 63.65, 58.34, 53.34, 48.88, 44.19, 40.51, 37.03, 34.47, 32.12, 28.60, 27.09, 26.70, 23.17, 22.47, 20.88, 19.90, 18.44, 17.80, 16.82, 14.87, 14.70, 13.19, 12.77, 12.29, 11.36, 10.86, 10.44, 10.20, 9.43, 9.54, 8.31, 7.42, 7.68, 7.68, 6.93, 6.40, 7.28, 5.83, 7.35, 4.00, 5.48, 4.90, 4.80, 4.47, 4.47, 5.00, 4.24, 3.32, 4.58, 3.00, 3.46, 3.74, 3.46, 3.32, 2.45, 3.00, 2.65, 2.65, 1.73, 2.45, 1.41, 2.45, 2.65, 2.65, 2.00, 1.00, 2.24, 2.24, 1.41, 1.41, 2.00, 2.00, 2.00, 1.00, 1.00, 1.00, 1.41, 1.00, 1.00, 0.00, 1.00, 0.00, 1.73, 1.00, 0.00, 1.00, 1.00, 0.00, 1.73, 1.00, 0.00, 0.00, 0.00, 1.41, 0.00, 0.00, 0.00, 1.00, 1.73, 0.00, 1.00, 0.00, 0.00, 0.00, 0.00, 1.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.00, 0.00, 1.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "DiPhoton"              : [0.00, 0.00, 0.00, 7.21, 33.24, 38.98, 39.09, 36.69, 32.85, 27.87, 31.00, 24.22, 19.60, 18.74, 14.61, 14.92, 12.88, 10.92, 9.74, 8.53, 8.73, 8.16, 7.48, 6.44, 6.28, 5.97, 10.65, 5.59, 5.47, 4.90, 4.47, 4.37, 4.22, 4.02, 4.01, 3.83, 4.63, 3.13, 2.88, 3.34, 3.01, 2.60, 2.49, 2.83, 3.02, 2.38, 2.34, 2.18, 1.90, 2.00, 1.79, 1.94, 2.31, 1.83, 1.53, 1.71, 1.75, 1.41, 1.94, 1.18, 1.35, 1.40, 1.69, 1.21, 1.20, 0.91, 1.08, 1.85, 1.32, 1.17, 1.24, 0.93, 0.93, 1.40, 0.87, 1.02, 1.06, 0.95, 0.75, 0.68, 0.70, 0.69, 1.10, 0.56, 0.60, 0.64, 0.83, 0.61, 1.08, 0.80, 0.79, 0.45, 0.44, 0.53, 0.36, 0.63, 0.58, 0.51, 0.55, 0.40, 0.54, 0.24, 0.29, 0.32, 0.22, 0.20, 0.62, 0.37, 0.19, 0.52, 0.24, 0.43, 0.30, 0.30, 0.28, 0.29, 0.19, 0.27, 0.68, 0.19, 0.14, 0.23, 0.20, 0.13, 0.27, 0.08, 0.19, 0.10, 0.13, 0.56, 0.05, 0.10, 0.05, 0.03, 0.26, 0.31, 0.21, 0.29, 0.23, 0.20, 0.40, 0.19, 0.06, 0.00, 0.14, 0.02, 0.43, 0.07, 0.18, 0.06, 0.28, 0.02, 0.18, 0.47, 0.27, 0.06, 0.33, 0.11, 0.36, 0.22, 0.05, 0.05, 0.27, 0.00, 0.05, 0.02, 0.03, 0.19, 0.00, 0.00, 0.39, 0.00, 0.00, 0.06, 0.02, 0.09, 0.00, 0.10, 0.03, 0.00, 0.46, 0.00, 0.00, 0.00, 0.06, 0.10, 0.00, 0.00, 0.06, 0.00, 0.02, 0.00, 0.34, 0.03, 0.00, 0.00, 0.08, 0.00, 0.00, 0.00, 0.18, 0.00, 0.00, 0.23, 0.00, 0.03, 0.20, 0.00, 0.00, 0.00, 0.00, 0.00, 0.06, 0.04, 0.00, 0.00, 0.00, 0.02, 0.00, 0.02, 0.00, 0.00, 0.00, 0.03, 0.00, 0.01, 0.00, 0.00, 0.00, 0.00, 0.06, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.03, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.06],
        "QCD_GammaJets_imputed" : [0.00, 0.00, 0.00, 21.90, 114.80, 133.92, 136.31, 132.29, 121.22, 114.98, 101.14, 92.82, 83.02, 76.45, 69.79, 62.51, 57.05, 51.79, 47.57, 43.16, 39.40, 35.54, 35.92, 30.50, 29.29, 26.75, 22.66, 22.21, 20.56, 18.78, 18.82, 18.05, 16.56, 14.81, 14.63, 12.62, 13.00, 11.07, 11.32, 10.56, 10.58, 9.61, 8.19, 8.08, 7.70, 8.15, 7.96, 6.66, 5.54, 5.63, 5.22, 6.24, 6.77, 6.03, 6.65, 4.47, 5.75, 3.73, 4.58, 3.55, 3.93, 3.90, 3.37, 3.29, 4.21, 4.47, 2.80, 2.52, 2.12, 2.83, 3.94, 0.00, 2.11, 1.59, 2.53, 2.24, 0.00, 2.38, 2.98, 2.17, 3.01, 1.68, 0.00, 0.00, 1.60, 1.69, 0.00, 2.17, 1.68, 0.00, 1.55, 0.00, 0.00, 1.71, 0.00, 1.69, 0.00, 0.00, 0.00, 1.59, 0.00, 0.00, 0.99, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.72, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.50, 0.00, 1.72, 0.00, 0.00, 0.62, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.67, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "TTGG"                  : [0.00, 0.00, 0.00, 0.08, 0.99, 2.32, 2.99, 6.22, 4.35, 6.26, 7.23, 7.89, 4.58, 6.76, 4.12, 5.53, 5.24, 8.01, 6.10, 11.73, 10.83, 4.03, 3.14, 8.18, 4.02, 5.42, 3.14, 2.70, 4.41, 1.44, 2.55, 10.39, 2.52, 2.92, 2.80, 1.95, 3.32, 3.33, 1.47, 1.61, 1.63, 1.35, 1.83, 0.48, 0.53, 0.57, 0.36, 1.96, 0.70, 2.07, 3.64, 0.50, 0.53, 0.38, 3.19, 0.29, 2.02, 0.25, 0.58, 0.26, 2.61, 0.37, 0.18, 0.19, 0.67, 0.17, 0.02, 2.55, 0.10, 0.09, 0.17, 0.88, 0.13, 0.03, 0.04, 0.21, 0.15, 0.37, 0.30, 0.13, 0.03, 0.17, 0.03, 0.06, 0.01, 0.05, 0.03, 0.23, 0.05, 0.08, 0.01, 0.01, 0.01, 0.10, 0.01, 0.01, 0.01, 0.01, 0.01, 0.21, 0.02, 0.01, 0.00, 0.00, 0.01, 0.00, 0.00, 0.24, 0.00, 0.12, 0.00, 0.15, 0.00, 0.01, 0.00, 0.01, 0.01, 0.00, 0.01, 0.00, 0.22, 0.00, 0.00, 0.00, 0.00, 0.13, 0.00, 0.00, 0.14, 0.00, 0.00, 0.00, 0.00, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.08, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "TTGJets"               : [0.00, 0.00, 0.00, 0.16, 5.30, 11.55, 9.58, 16.17, 15.09, 16.24, 23.28, 16.97, 18.96, 17.00, 21.60, 17.50, 14.22, 13.68, 10.75, 10.46, 11.04, 10.43, 11.53, 11.50, 9.17, 8.19, 13.90, 8.82, 3.81, 8.81, 7.97, 6.16, 3.63, 4.60, 7.84, 1.91, 5.49, 2.48, 4.80, 3.00, 7.56, 3.20, 2.21, 0.89, 0.97, 4.31, 7.35, 0.67, 6.14, 0.92, 0.58, 1.83, 0.90, 1.36, 0.35, 0.58, 0.29, 0.28, 0.33, 1.20, 0.25, 0.37, 0.22, 0.14, 1.45, 0.20, 5.74, 0.72, 0.23, 0.32, 0.35, 0.07, 0.01, 0.18, 0.17, 0.18, 0.06, 0.00, 0.02, 0.25, 0.11, 0.07, 0.13, 0.03, 0.18, 0.00, 0.20, 0.00, 0.36, 0.16, 0.00, 0.00, 0.00, 0.21, 0.16, 0.01, 0.00, 0.00, 0.17, 1.79, 0.00, 0.14, 0.24, 0.00, 0.00, 0.00, 0.00, 0.14, 0.00, 0.00, 0.00, 0.18, 0.00, 0.00, 0.00, 0.00, 0.09, 0.15, 0.00, 0.00, 0.00, 0.21, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.08, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.04, 0.00, 0.14, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "TTJets"                : [0.00, 0.00, 0.00, 0.00, 3.84, 9.79, 16.37, 16.90, 27.26, 22.33, 20.31, 19.81, 26.64, 26.05, 26.45, 22.32, 21.37, 16.77, 18.76, 18.56, 18.74, 9.47, 12.68, 11.44, 11.95, 11.75, 3.99, 11.58, 8.91, 3.22, 5.98, 2.57, 2.53, 3.35, 2.75, 2.41, 5.34, 1.97, 1.34, 1.21, 3.02, 1.56, 1.86, 1.54, 0.02, 0.00, 0.63, 0.38, 0.54, 1.13, 0.18, 1.09, 1.19, 0.01, 0.00, 1.24, 0.00, 0.04, 0.00, 0.00, 0.72, 0.00, 1.19, 1.35, 0.09, 0.38, 0.00, 0.00, 0.00, 0.00, 1.88, 0.07, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.90, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.25, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
         "VG"                   : [0.00, 0.00, 0.00, 0.72, 18.05, 15.96, 9.62, 15.90, 9.39, 13.26, 22.38, 6.93, 10.80, 24.41, 12.12, 12.70, 15.14, 9.84, 11.55, 3.50, 11.77, 9.96, 3.04, 11.97, 2.26, 14.46, 8.88, 2.32, 2.00, 10.05, 1.61, 1.74, 1.88, 1.85, 1.45, 0.99, 10.64, 0.93, 0.65, 1.99, 1.33, 0.90, 0.67, 2.36, 0.75, 0.00, 2.15, 1.55, 0.61, 0.95, 2.02, 0.00, 0.00, 0.00, 0.93, 0.12, 0.43, 0.00, 0.00, 0.00, 0.00, 1.47, 0.27, 1.53, 0.00, 0.00, 0.56, 0.00, 1.22, 0.00, 0.00, 0.00, 0.36, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.31, 0.00, 0.00, 0.78, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.09, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
            } #}}}
    # local leg {{{
    c1.SetRightMargin(0.2)
    legend = ROOT.TLegend(0.82, 0.60, 0.98, 0.85)
    legend.SetLineColor(0)
    legend.SetTextSize(0.04)
    legend.Clear()
    #}}}

    raw_values = raw_values_n250
    raw_errors = raw_vales_error_n250
    n = len(raw_values['Data']) 
    n = 50 
    x = array.array('d')

    # convert raw yields to array {{{
    v_yields, v_uncs = [], []
    data_yields, data_uncs = array.array('d'), array.array('d')
    tot_yields, tot_uncs = [0. for i in range(n)], [0. for i in range(n)]
    for i, p in enumerate(processes):
        yields, uncs = array.array('d'), array.array('d')
        for j in range(n):
            if i==0: # process the follows only once
                x.append(j*20 + 10)
                data_yields.append(raw_values['Data'][j])
                data_uncs.append(raw_errors['Data'][j])
            yields.append(raw_values[p][j]) 
            uncs.append(raw_errors[p][j]) 
            tot_yields[j] += raw_values[p][j]
            tot_uncs[j] += pow(raw_errors[p][j], 2)
        v_yields.append(yields)
        v_uncs.append(uncs)
    
    for j in range(n):
        tot_uncs[j] = math.sqrt(tot_uncs[j])
    #}}}
    # calculate composition {{{
    v_graphs = []
    for i, p in enumerate(processes):
        composition = array.array('d')
        for j in range(n):
            composition.append(v_yields[i][j]/tot_yields[j] if tot_yields[j]>0. else 0.) 
        gr = ROOT.TGraph(n, x, composition)
        set_graph(gr, "Composition", xtitles["hHT"], default_color_scheme[p])

        if i==0:
            gr.SetMaximum(1.0)
            gr.SetMinimum(1e-4)
            gr.Draw('ACP')
        else:
            gr.Draw('CP')

        legend.AddEntry(gr, labels[p], "lp")
        v_graphs.append(gr)

    annotate(0., 0.12)
    legend.Draw("same")
    output = dir_output + "/HT_bin_composition"
    c1.SaveAs(output + ".png")
    c1.SaveAs(output + ".pdf")
    #}}}
#}}}
def make_scale_factor(draw_variation=False): #{{{
    c1.cd()
    backgrounds = "DiPhoton|QCD_GammaJets_imputed|TTGG|TTGJets|TTJets|VG"
    processes = backgrounds.split('|')
    raw_values_n50 = { #{{{
        "Data": [14690.00, 85142.00, 38380.00, 14642.00, 6050.00, 2925.00, 1557.00, 833.00, 511.00, 290.00, 198.00, 117.00, 84.00, 55.00, 32.00, 26.00, 15.00, 14.00, 5.00, 5.00, 6.00, 2.00, 4.00, 1.00, 1.00, 2.00, 0.00, 0.00, 0.00, 1.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "DiPhoton"       : [2797.85, 22667.67, 12055.98, 5436.62, 2796.55, 1578.45, 911.29, 564.15, 357.59, 238.55, 155.99, 114.38, 82.10, 57.60, 42.32, 31.51, 24.55, 20.53, 12.14, 10.88, 5.58, 5.70, 4.75, 3.83, 2.48, 2.22, 0.89, 2.25, 1.27, 1.27, 1.64, 1.21, 0.47, 0.28, 0.53, 0.27, 0.56, 0.18, 0.39, 0.12, 0.41, 0.23, 0.13, 0.04, 0.03, 0.01, 0.06, 0.00, 0.03, 0.00, 0.06],
        "QCD_GammaJets_imputed": [9889.18, 58529.73, 25861.61, 9781.38, 4089.47, 1733.56, 950.89, 470.45, 268.22, 163.90, 126.47, 66.38, 47.70, 31.34, 18.60, 15.48, 9.39, 6.45, 3.87, 3.28, 0.99, 1.72, 0.00, 0.00, 3.22, 0.62, 1.67, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "TTGG"           : [-0.69, 29.69, 90.66, 104.93, 70.36, 27.84, 40.26, 24.28, 8.36, 9.05, 9.25, 5.42, 4.42, 3.84, -0.19, 1.24, -0.10, 0.43, 0.18, 0.25, 0.01, 0.48, 0.18, 0.04, 0.23, 0.27, 0.02, -0.00, 0.08, 0.00, -0.00, 0.01, 0.00, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "TTGJets"        : [10.62, 267.89, 306.58, 251.32, 102.71, 74.49, 29.45, 40.34, 21.49, 26.87, 4.90, 3.87, 3.04, -2.78, 0.45, 0.66, -0.19, 1.08, 0.29, -1.63, 0.38, -0.13, 0.18, 0.24, 0.21, 0.08, 0.00, 0.00, 0.09, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "TTJets"         : [3.42, 274.87, 296.71, 196.92, 38.63, 19.69, 6.31, 18.23, 1.43, 2.19, 2.84, 1.27, 3.15, -0.32, 1.80, 0.00, 0.00, 1.90, 1.25, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "VG"             : [74.12, 390.78, 235.17, 153.41, 69.34, 67.45, 17.83, 20.05, 5.87, 2.44, 4.24, 0.70, 2.02, 1.78, 0.36, 0.00, 0.00, 1.16, 0.00, 0.00, 0.00, 0.00, 0.09, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
    } #}}}
    raw_values_n250 = { #{{{
        "Data": [0.00, 0.00, 0.00, 594.00, 14096.00, 18898.00, 19738.00, 17763.00, 15612.00, 13131.00, 10960.00, 9004.00, 7460.00, 5963.00, 4993.00, 4051.00, 3404.00, 2845.00, 2389.00, 1953.00, 1641.00, 1371.00, 1188.00, 1032.00, 818.00, 734.00, 713.00, 537.00, 505.00, 436.00, 396.00, 340.00, 317.00, 283.00, 221.00, 216.00, 174.00, 163.00, 151.00, 129.00, 118.00, 109.00, 104.00, 89.00, 91.00, 69.00, 55.00, 59.00, 59.00, 48.00, 41.00, 53.00, 34.00, 54.00, 16.00, 30.00, 24.00, 23.00, 20.00, 20.00, 25.00, 18.00, 11.00, 21.00, 9.00, 12.00, 14.00, 12.00, 11.00, 6.00, 9.00, 7.00, 7.00, 3.00, 6.00, 2.00, 6.00, 7.00, 7.00, 4.00, 1.00, 5.00, 5.00, 2.00, 2.00, 4.00, 4.00, 4.00, 1.00, 1.00, 1.00, 2.00, 1.00, 1.00, 0.00, 1.00, 0.00, 3.00, 1.00, 0.00, 1.00, 1.00, 0.00, 3.00, 1.00, 0.00, 0.00, 0.00, 2.00, 0.00, 0.00, 0.00, 1.00, 3.00, 0.00, 1.00, 0.00, 0.00, 0.00, 0.00, 1.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.00, 0.00, 1.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "DiPhoton": [0.00, 0.00, 0.00, 96.12, 2701.73, 4462.91, 5084.38, 4918.30, 4401.43, 3800.65, 3282.06, 2793.47, 2321.73, 1992.01, 1666.71, 1444.04, 1244.94, 1047.21, 911.42, 789.01, 700.12, 629.41, 557.94, 479.00, 430.09, 382.27, 356.37, 304.89, 288.05, 246.88, 218.20, 195.50, 184.58, 161.94, 151.07, 134.83, 127.10, 110.16, 96.38, 95.69, 87.74, 77.03, 67.84, 66.99, 57.98, 54.78, 51.75, 48.93, 42.23, 40.85, 36.42, 34.48, 33.29, 27.26, 24.54, 26.98, 24.30, 21.19, 24.27, 17.64, 17.87, 18.57, 17.60, 14.45, 13.61, 11.05, 11.57, 12.98, 10.50, 11.50, 9.39, 8.35, 7.73, 9.28, 7.57, 7.45, 8.12, 6.25, 5.19, 4.50, 4.75, 4.53, 7.29, 3.76, 4.22, 3.81, 4.47, 3.56, 3.97, 4.72, 4.05, 2.17, 2.04, 2.29, 1.59, 2.63, 2.31, 1.63, 2.30, 2.01, 1.38, 1.16, 1.03, 1.19, 0.80, 0.65, 1.54, 0.94, 0.60, 1.96, 0.82, 1.28, 0.93, 0.71, 1.01, 0.88, 0.54, 0.64, 1.31, 0.45, 0.46, 0.57, 0.46, 0.35, 0.64, 0.12, 0.48, 0.22, 0.27, 1.13, 0.09, 0.25, 0.09, 0.06, 0.40, 0.71, 0.25, 0.46, 0.48, 0.35, 0.70, 0.25, 0.10, 0.00, 0.22, 0.03, 0.71, 0.12, 0.30, 0.10, 0.32, 0.02, 0.18, 0.66, 0.46, 0.08, 0.38, 0.14, 0.36, 0.25, 0.05, 0.07, 0.27, 0.00, 0.07, 0.02, 0.03, 0.23, 0.00, 0.00, 0.41, 0.00, 0.00, 0.09, 0.03, 0.13, 0.00, 0.11, 0.03, 0.00, 0.49, 0.00, 0.00, 0.00, 0.06, 0.10, 0.00, 0.00, 0.08, 0.00, 0.02, 0.00, 0.34, 0.03, 0.00, 0.00, 0.12, 0.00, 0.00, 0.00, 0.18, 0.00, 0.00, 0.23, 0.00, 0.03, 0.20, 0.00, 0.00, 0.00, 0.00, 0.00, 0.08, 0.04, 0.00, 0.00, 0.00, 0.02, 0.00, 0.02, 0.00, 0.00, 0.00, 0.03, 0.00, 0.01, 0.00, 0.00, 0.00, 0.00, 0.06, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.03, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.06],
        "QCD_GammaJets_imputed": [0.00, 0.00, 0.00, 347.93, 9541.25, 12877.45, 13329.05, 12486.81, 10473.64, 9362.79, 7297.64, 6120.98, 4876.88, 4141.55, 3424.56, 2731.61, 2287.12, 1876.20, 1580.28, 1306.17, 1088.60, 881.92, 887.66, 640.69, 590.60, 489.49, 358.06, 342.68, 301.45, 241.87, 243.39, 220.64, 189.41, 153.08, 144.38, 105.08, 117.25, 82.85, 87.43, 77.83, 76.33, 60.33, 43.83, 45.50, 42.23, 44.76, 43.42, 31.65, 21.83, 22.25, 19.97, 24.74, 29.03, 23.64, 29.08, 12.94, 20.37, 11.13, 14.02, 7.92, 11.53, 9.76, 7.55, 7.88, 10.98, 12.95, 5.54, 4.33, 3.64, 4.88, 9.76, 0.00, 2.98, 1.59, 4.27, 3.16, 0.00, 3.36, 5.79, 3.17, 5.94, 1.68, 0.00, 0.00, 1.77, 1.69, 0.00, 3.06, 1.70, 0.00, 2.16, 0.00, 0.00, 1.71, 0.00, 1.69, 0.00, 0.00, 0.00, 1.59, 0.00, 0.00, 0.99, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.72, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.50, 0.00, 1.72, 0.00, 0.00, 0.62, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.67, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "TTGG": [0.00, 0.00, 0.00, 0.08, -0.77, 4.69, 5.37, 2.36, 7.21, 10.06, 24.35, 22.74, 12.49, 14.91, 16.16, 23.20, 19.92, 12.40, 23.29, 26.12, 18.65, 18.30, 6.07, 15.96, 11.38, -0.07, 8.47, 6.72, 8.17, 4.55, 6.74, 14.11, 7.34, 4.67, 7.39, 4.23, 7.26, 5.93, 3.70, 3.16, 1.16, 2.86, 1.59, 1.47, 1.28, 1.21, 0.97, 1.96, 1.33, 3.57, 4.20, 0.02, 0.44, 0.87, 3.72, -0.06, 3.30, 0.85, 1.29, 0.05, 2.86, 0.57, 0.19, -0.13, 0.93, 0.20, 0.09, 3.19, 0.18, 0.17, 0.35, -0.82, 0.14, 0.07, 0.07, 0.17, 0.08, 0.61, 0.39, -0.01, 0.03, -0.18, 0.05, -0.01, 0.02, 0.08, -0.02, 0.32, -0.04, 0.10, 0.01, -0.00, 0.01, 0.14, 0.02, 0.01, 0.01, -0.00, 0.02, 0.22, -0.01, -0.00, 0.01, 0.00, 0.01, 0.01, 0.01, 0.32, 0.01, 0.13, 0.01, 0.15, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.22, -0.00, 0.00, 0.00, 0.00, 0.13, 0.00, 0.00, 0.14, 0.00, -0.00, 0.00, 0.01, 0.01, 0.01, 0.00, 0.00, 0.00, -0.01, -0.00, -0.00, 0.09, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 0.00, 0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "TTGJets": [0.00, 0.00, 0.00, 0.16, 10.46, 24.30, 30.34, 55.71, 74.55, 82.98, 91.45, 64.26, 62.30, 65.56, 23.01, 74.29, 51.82, 40.87, 35.64, 48.71, 37.84, 4.87, 21.29, 29.62, 9.10, 15.16, 27.15, 9.13, 9.67, 13.38, 11.49, 0.50, 1.68, 8.09, 7.69, 6.32, 12.85, 4.50, 9.13, 7.54, 9.47, 6.07, 5.05, 1.48, -0.58, 5.36, 11.44, 0.73, 8.17, 1.17, 1.37, 1.01, 0.25, 2.18, 0.09, 0.89, 0.34, -0.02, 0.52, 2.13, 0.57, 0.72, -0.10, -0.23, 2.08, 0.14, -4.28, 1.16, -0.29, 0.49, 0.35, -0.07, 0.01, 0.20, -0.05, 0.33, 0.06, 0.00, 0.02, 0.26, 0.18, 0.01, -0.07, -0.03, -0.29, 0.00, 0.28, -0.00, 0.58, 0.22, 0.00, -0.00, 0.00, 0.29, 0.00, -0.00, -0.00, 0.00, 0.17, -1.79, 0.00, 0.14, 0.24, 0.00, -0.00, 0.00, 0.00, -0.14, 0.00, 0.00, 0.00, 0.18, 0.00, 0.00, 0.00, 0.00, 0.09, 0.15, 0.00, 0.00, 0.00, 0.21, 0.00, 0.00, 0.00, 0.00, 0.00, -0.00, 0.00, 0.08, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, -0.04, 0.00, 0.14, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "TTJets": [0.00, 0.00, 0.00, 0.00, 3.42, 29.76, 55.87, 46.15, 76.47, 66.61, 92.57, 68.45, 107.78, 19.56, 8.35, 35.27, 51.51, 30.46, 49.35, 30.32, -22.91, 11.33, 18.79, 9.53, 21.89, 2.97, 4.12, 11.36, -1.12, 2.37, -2.56, 3.11, 1.04, -1.34, 6.07, 4.24, 9.83, 1.19, 1.68, 1.28, 2.00, 1.18, -1.86, 0.11, -0.01, -0.00, 0.70, 0.38, 0.54, 0.57, 0.25, 1.12, 1.46, 0.01, 0.00, 1.24, -0.00, 0.04, 0.00, 0.00, 0.72, 0.00, 1.19, 1.33, -0.09, -0.32, 0.00, 0.00, 0.00, 0.00, 1.88, -0.07, 0.00, 0.00, -0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.90, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.25, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "VG": [0.00, 0.00, 0.00, 1.10, 73.02, 88.58, 72.35, 83.64, 80.08, 66.15, 69.47, 43.00, 49.84, 59.18, 13.68, 43.24, 49.76, 20.35, 24.24, 15.82, 26.99, 6.61, 7.94, 20.43, 7.37, 24.79, 16.35, 4.68, 2.22, 19.42, 3.10, 3.25, 3.64, 4.29, 3.55, 0.82, 13.13, 1.59, 0.79, 3.72, 1.48, 1.16, 0.68, 1.80, 0.75, 0.00, -0.96, 3.04, -0.59, 0.95, 3.30, 0.00, 0.00, 0.00, 0.93, 0.13, 0.57, 0.00, 0.00, 0.00, 0.00, 0.38, -0.27, 1.91, 0.00, 0.00, 0.56, 0.00, 1.22, 0.00, 0.00, 0.00, 0.36, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.31, 0.00, 0.00, 0.85, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.09, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
    } #}}}
    raw_vales_error_n250 = { #{{{
        "Data"                  : [0.00, 0.00, 0.00, 24.37, 118.73, 137.47, 140.49, 133.28, 124.95, 114.59, 104.69, 94.89, 86.37, 77.22, 70.66, 63.65, 58.34, 53.34, 48.88, 44.19, 40.51, 37.03, 34.47, 32.12, 28.60, 27.09, 26.70, 23.17, 22.47, 20.88, 19.90, 18.44, 17.80, 16.82, 14.87, 14.70, 13.19, 12.77, 12.29, 11.36, 10.86, 10.44, 10.20, 9.43, 9.54, 8.31, 7.42, 7.68, 7.68, 6.93, 6.40, 7.28, 5.83, 7.35, 4.00, 5.48, 4.90, 4.80, 4.47, 4.47, 5.00, 4.24, 3.32, 4.58, 3.00, 3.46, 3.74, 3.46, 3.32, 2.45, 3.00, 2.65, 2.65, 1.73, 2.45, 1.41, 2.45, 2.65, 2.65, 2.00, 1.00, 2.24, 2.24, 1.41, 1.41, 2.00, 2.00, 2.00, 1.00, 1.00, 1.00, 1.41, 1.00, 1.00, 0.00, 1.00, 0.00, 1.73, 1.00, 0.00, 1.00, 1.00, 0.00, 1.73, 1.00, 0.00, 0.00, 0.00, 1.41, 0.00, 0.00, 0.00, 1.00, 1.73, 0.00, 1.00, 0.00, 0.00, 0.00, 0.00, 1.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.00, 0.00, 1.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "DiPhoton"              : [0.00, 0.00, 0.00, 7.21, 33.24, 38.98, 39.09, 36.69, 32.85, 27.87, 31.00, 24.22, 19.60, 18.74, 14.61, 14.92, 12.88, 10.92, 9.74, 8.53, 8.73, 8.16, 7.48, 6.44, 6.28, 5.97, 10.65, 5.59, 5.47, 4.90, 4.47, 4.37, 4.22, 4.02, 4.01, 3.83, 4.63, 3.13, 2.88, 3.34, 3.01, 2.60, 2.49, 2.83, 3.02, 2.38, 2.34, 2.18, 1.90, 2.00, 1.79, 1.94, 2.31, 1.83, 1.53, 1.71, 1.75, 1.41, 1.94, 1.18, 1.35, 1.40, 1.69, 1.21, 1.20, 0.91, 1.08, 1.85, 1.32, 1.17, 1.24, 0.93, 0.93, 1.40, 0.87, 1.02, 1.06, 0.95, 0.75, 0.68, 0.70, 0.69, 1.10, 0.56, 0.60, 0.64, 0.83, 0.61, 1.08, 0.80, 0.79, 0.45, 0.44, 0.53, 0.36, 0.63, 0.58, 0.51, 0.55, 0.40, 0.54, 0.24, 0.29, 0.32, 0.22, 0.20, 0.62, 0.37, 0.19, 0.52, 0.24, 0.43, 0.30, 0.30, 0.28, 0.29, 0.19, 0.27, 0.68, 0.19, 0.14, 0.23, 0.20, 0.13, 0.27, 0.08, 0.19, 0.10, 0.13, 0.56, 0.05, 0.10, 0.05, 0.03, 0.26, 0.31, 0.21, 0.29, 0.23, 0.20, 0.40, 0.19, 0.06, 0.00, 0.14, 0.02, 0.43, 0.07, 0.18, 0.06, 0.28, 0.02, 0.18, 0.47, 0.27, 0.06, 0.33, 0.11, 0.36, 0.22, 0.05, 0.05, 0.27, 0.00, 0.05, 0.02, 0.03, 0.19, 0.00, 0.00, 0.39, 0.00, 0.00, 0.06, 0.02, 0.09, 0.00, 0.10, 0.03, 0.00, 0.46, 0.00, 0.00, 0.00, 0.06, 0.10, 0.00, 0.00, 0.06, 0.00, 0.02, 0.00, 0.34, 0.03, 0.00, 0.00, 0.08, 0.00, 0.00, 0.00, 0.18, 0.00, 0.00, 0.23, 0.00, 0.03, 0.20, 0.00, 0.00, 0.00, 0.00, 0.00, 0.06, 0.04, 0.00, 0.00, 0.00, 0.02, 0.00, 0.02, 0.00, 0.00, 0.00, 0.03, 0.00, 0.01, 0.00, 0.00, 0.00, 0.00, 0.06, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.03, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.06],
        "QCD_GammaJets_imputed" : [0.00, 0.00, 0.00, 21.90, 114.80, 133.92, 136.31, 132.29, 121.22, 114.98, 101.14, 92.82, 83.02, 76.45, 69.79, 62.51, 57.05, 51.79, 47.57, 43.16, 39.40, 35.54, 35.92, 30.50, 29.29, 26.75, 22.66, 22.21, 20.56, 18.78, 18.82, 18.05, 16.56, 14.81, 14.63, 12.62, 13.00, 11.07, 11.32, 10.56, 10.58, 9.61, 8.19, 8.08, 7.70, 8.15, 7.96, 6.66, 5.54, 5.63, 5.22, 6.24, 6.77, 6.03, 6.65, 4.47, 5.75, 3.73, 4.58, 3.55, 3.93, 3.90, 3.37, 3.29, 4.21, 4.47, 2.80, 2.52, 2.12, 2.83, 3.94, 0.00, 2.11, 1.59, 2.53, 2.24, 0.00, 2.38, 2.98, 2.17, 3.01, 1.68, 0.00, 0.00, 1.60, 1.69, 0.00, 2.17, 1.68, 0.00, 1.55, 0.00, 0.00, 1.71, 0.00, 1.69, 0.00, 0.00, 0.00, 1.59, 0.00, 0.00, 0.99, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.72, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.50, 0.00, 1.72, 0.00, 0.00, 0.62, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.67, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "TTGG"                  : [0.00, 0.00, 0.00, 0.08, 0.99, 2.32, 2.99, 6.22, 4.35, 6.26, 7.23, 7.89, 4.58, 6.76, 4.12, 5.53, 5.24, 8.01, 6.10, 11.73, 10.83, 4.03, 3.14, 8.18, 4.02, 5.42, 3.14, 2.70, 4.41, 1.44, 2.55, 10.39, 2.52, 2.92, 2.80, 1.95, 3.32, 3.33, 1.47, 1.61, 1.63, 1.35, 1.83, 0.48, 0.53, 0.57, 0.36, 1.96, 0.70, 2.07, 3.64, 0.50, 0.53, 0.38, 3.19, 0.29, 2.02, 0.25, 0.58, 0.26, 2.61, 0.37, 0.18, 0.19, 0.67, 0.17, 0.02, 2.55, 0.10, 0.09, 0.17, 0.88, 0.13, 0.03, 0.04, 0.21, 0.15, 0.37, 0.30, 0.13, 0.03, 0.17, 0.03, 0.06, 0.01, 0.05, 0.03, 0.23, 0.05, 0.08, 0.01, 0.01, 0.01, 0.10, 0.01, 0.01, 0.01, 0.01, 0.01, 0.21, 0.02, 0.01, 0.00, 0.00, 0.01, 0.00, 0.00, 0.24, 0.00, 0.12, 0.00, 0.15, 0.00, 0.01, 0.00, 0.01, 0.01, 0.00, 0.01, 0.00, 0.22, 0.00, 0.00, 0.00, 0.00, 0.13, 0.00, 0.00, 0.14, 0.00, 0.00, 0.00, 0.00, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.08, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "TTGJets"               : [0.00, 0.00, 0.00, 0.16, 5.30, 11.55, 9.58, 16.17, 15.09, 16.24, 23.28, 16.97, 18.96, 17.00, 21.60, 17.50, 14.22, 13.68, 10.75, 10.46, 11.04, 10.43, 11.53, 11.50, 9.17, 8.19, 13.90, 8.82, 3.81, 8.81, 7.97, 6.16, 3.63, 4.60, 7.84, 1.91, 5.49, 2.48, 4.80, 3.00, 7.56, 3.20, 2.21, 0.89, 0.97, 4.31, 7.35, 0.67, 6.14, 0.92, 0.58, 1.83, 0.90, 1.36, 0.35, 0.58, 0.29, 0.28, 0.33, 1.20, 0.25, 0.37, 0.22, 0.14, 1.45, 0.20, 5.74, 0.72, 0.23, 0.32, 0.35, 0.07, 0.01, 0.18, 0.17, 0.18, 0.06, 0.00, 0.02, 0.25, 0.11, 0.07, 0.13, 0.03, 0.18, 0.00, 0.20, 0.00, 0.36, 0.16, 0.00, 0.00, 0.00, 0.21, 0.16, 0.01, 0.00, 0.00, 0.17, 1.79, 0.00, 0.14, 0.24, 0.00, 0.00, 0.00, 0.00, 0.14, 0.00, 0.00, 0.00, 0.18, 0.00, 0.00, 0.00, 0.00, 0.09, 0.15, 0.00, 0.00, 0.00, 0.21, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.08, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.04, 0.00, 0.14, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
        "TTJets"                : [0.00, 0.00, 0.00, 0.00, 3.84, 9.79, 16.37, 16.90, 27.26, 22.33, 20.31, 19.81, 26.64, 26.05, 26.45, 22.32, 21.37, 16.77, 18.76, 18.56, 18.74, 9.47, 12.68, 11.44, 11.95, 11.75, 3.99, 11.58, 8.91, 3.22, 5.98, 2.57, 2.53, 3.35, 2.75, 2.41, 5.34, 1.97, 1.34, 1.21, 3.02, 1.56, 1.86, 1.54, 0.02, 0.00, 0.63, 0.38, 0.54, 1.13, 0.18, 1.09, 1.19, 0.01, 0.00, 1.24, 0.00, 0.04, 0.00, 0.00, 0.72, 0.00, 1.19, 1.35, 0.09, 0.38, 0.00, 0.00, 0.00, 0.00, 1.88, 0.07, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.90, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1.25, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
         "VG"                   : [0.00, 0.00, 0.00, 0.72, 18.05, 15.96, 9.62, 15.90, 9.39, 13.26, 22.38, 6.93, 10.80, 24.41, 12.12, 12.70, 15.14, 9.84, 11.55, 3.50, 11.77, 9.96, 3.04, 11.97, 2.26, 14.46, 8.88, 2.32, 2.00, 10.05, 1.61, 1.74, 1.88, 1.85, 1.45, 0.99, 10.64, 0.93, 0.65, 1.99, 1.33, 0.90, 0.67, 2.36, 0.75, 0.00, 2.15, 1.55, 0.61, 0.95, 2.02, 0.00, 0.00, 0.00, 0.93, 0.12, 0.43, 0.00, 0.00, 0.00, 0.00, 1.47, 0.27, 1.53, 0.00, 0.00, 0.56, 0.00, 1.22, 0.00, 0.00, 0.00, 0.36, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.31, 0.00, 0.00, 0.78, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.09, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00],
            } #}}}
    # local leg {{{
    c1.SetRightMargin(0.2)
    legend = ROOT.TLegend(0.82, 0.60, 0.98, 0.85)
    legend.SetLineColor(0)
    legend.SetTextSize(0.04)
    legend.Clear()
    #}}}

    raw_values = raw_values_n250
    raw_errors = raw_vales_error_n250
    n = len(raw_values['Data']) 
    n = 50 
    x = array.array('d')

    # convert raw yields to array {{{
    v_yields, v_uncs = [], []
    data_yields, data_uncs = array.array('d'), array.array('d')
    tot_yields, tot_uncs = [0. for i in range(n)], [0. for i in range(n)]
    for i, p in enumerate(processes):
        yields, uncs = array.array('d'), array.array('d')
        for j in range(n):
            if i==0: # process the follows only once
                x.append(j*20 + 10)
                data_yields.append(raw_values['Data'][j])
                data_uncs.append(raw_errors['Data'][j])
            yields.append(raw_values[p][j]) 
            uncs.append(raw_errors[p][j]) 
            tot_yields[j] += raw_values[p][j]
            tot_uncs[j] += pow(raw_errors[p][j], 2)
        v_yields.append(yields)
        v_uncs.append(uncs)
    
    for j in range(n):
        tot_uncs[j] = math.sqrt(tot_uncs[j])
    #}}}

    #--------------------------------------------------
    # calculate SFs
    #--------------------------------------------------
    c1.SetLogy(0)
    legend.Clear()

    processes = ['Data']
    v_graphs = []
    for i, p in enumerate(processes):
        ex = array.array('d')
        ey = array.array('d')
        scale_factors = array.array('d')
        for j in range(n):
            ex.append(10.)
            unc = calclate_eff_unc(data_yields[j], tot_yields[j], tot_uncs[j])
            ey.append(unc)
            scale_factors.append(data_yields[j]/tot_yields[j] if tot_yields[j]>0. else 1.) 
            #print ">>> check:",  scale_factors[j], unc, data_yields[j], tot_yields[j], tot_uncs[j]
        #gr = ROOT.TGraphErrors(n, x, scale_factors, ex, ey)
        #gr = ROOT.TGraph(n-3, x[3:], scale_factors[3:])
        gr = ROOT.TGraphErrors(n-3, x[3:], scale_factors[3:], ex[3:], ey[3:])
        set_graph(gr, "#frac{Data}{MC} / 20 GeV", xtitles["hHT"], default_color_scheme[p])

        if i==0:
            gr.SetMaximum(2.0)
            gr.SetMinimum(0)
            gr.Draw('AP')
        else:
            gr.Draw('P')

        #legend.AddEntry(gr, labels[p], "lp")
        v_graphs.append(gr)

    f1 = ROOT.TF1('f1', "[0] + [1]*x", 100, 20.*n)
    v_graphs[0].Fit(f1, "", "", 100, 20.*n)
    #print f1.Eval(100), f1.Eval(200), f1.Eval(400), f1.Eval(800)

    if draw_variation:
        p0 = 1.11181e+00
        p1 = -5.30993e-04

        f2 = ROOT.TF1('f2', "[0] + [1]*x", 100, 20.*n)
        f2.SetParameters(p0*1.5, p1)
        f2.SetLineColor(ROOT.kBlue)
        f2.SetLineStyle(2)
        f2.Draw("same")

        f3 = ROOT.TF1('f3', "[0] + [1]*x", 100, 20.*n)
        f3.SetParameters(p0*0.5, p1)
        f3.SetLineColor(ROOT.kBlue)
        f3.SetLineStyle(2)
        f3.Draw("same")

    my_stat_pos = [0.77, 0.87, 0.15, 0.15]
    ROOT.gStyle.SetStatX(my_stat_pos[0])
    ROOT.gStyle.SetStatY(my_stat_pos[1])
    ROOT.gStyle.SetStatW(my_stat_pos[2])
    ROOT.gStyle.SetStatH(my_stat_pos[3])

    tag = "_variation" if draw_variation else ""
    annotate(0., 0.12)
    legend.Draw("same")
    output = dir_output + "/HT_scale_factor" + tag
    c1.SaveAs(output + ".png")
    c1.SaveAs(output + ".pdf")
#}}}
def make_plot(varName, myMasses, plotType, pauseFit): #{{{
    # Init {{{
    c1.cd()
    nameTag = varName + "_" + plotType

    legend = ROOT.TLegend(0.58, 0.60, 0.90, 0.85)
    legend.SetLineColor(0)
    legend.SetTextSize(0.05)
    legend.Clear()

    backgrounds = "DiPhoton|QCD|GammaJets|TTGG|TTGJets|TTJets|VG" # pure MC
    backgrounds = "DiPhoton|QCD_GammaJets_imputed|TTGG|TTGJets|TTJets|TGamma|VG|VV"
    backgrounds = "QCD_GammaJets_imputed|QCD|GammaJets"

    processes = backgrounds.split('|')
    #}}}
    # load hists {{{
    hs = ROOT.THStack("hs", ";%s;Yields" % (ytitles[plotType][varName]));
    v_hists, v_herrs = [], []
    for p in processes:
        histName = varName + "_" + str(p)
        h = fin.Get(histName)
        v_hists.append(h)

        h_err = h.Clone()
        v_herrs.append(h_err)
    #}}}
    # loop over hists
    h_tot = v_hists[0].Clone()
    h_tot_err = v_hists[0].Clone()
    for i, h in enumerate(v_hists):
        h_err = v_herrs[i]
        # normalize area #{{{
        if plotType == "normalized":
            unc = ctypes.c_double(0.) 
            nbins = h.GetSize()-1
            tot_yields = h.IntegralAndError(0, nbins, unc)
            if tot_yields > 0.:
                h.Scale(1./tot_yields)
                h_err.Scale(1./tot_yields)
        #}}}
        # set / add hist {{{
        set_the_hist(h, varName, ranges[varName], plotType, xtitles[varName], ytitles[plotType][varName], default_color_scheme[processes[i]], dataLike=(i==0))
        set_the_error_band(h_err)

        #if i<2: legend.AddEntry(h, myLabel[processes[i]], "lep" if i==0 else "l")

        if i==0:
            h.Scale(1.076398) # normalization from a simultaneous fit to photon IDMVAs
        else:
            hs.Add(h)
            if i==1:
                h_tot = h.Clone()
                h_tot_err = h_err.Clone()
            else:
                h_tot.Add(h)
                h_tot_err.Add(h_err)
        #}}}
        print ">>> ", i, processes[i], get_total_yields(h)

    # scale MC & set legend and ratio pad {{{
    ## scale first several bins from HT
    scale_factor = get_total_yields(v_hists[0], 8) / get_total_yields(h_tot, 8)
    print ">>> scale_factor =", scale_factor
    my_manual_factor = scale_factor

    #my_manual_factor = 4.5
    h_tot.Scale(my_manual_factor)
    h_tot_err.Scale(my_manual_factor)

    legend.AddEntry(v_hists[0], myLabel[processes[0]], "lep")
    legend.AddEntry(h_tot, myLabel[processes[1]], "f")

    h_ratio = v_hists[0].Clone()
    h_ratio.Divide(h_tot)
    set_ratio_hist(h_ratio, xtitles[varName])

    create_pad()
    #}}}
    # wrap up {{{
    v_hists.append(h_tot)
    maximum = get_maximum(v_hists)
    scaleTags = ["linear", "log"]
    for scaleTag in scaleTags:
        if scaleTag == "linear":
            pad1.SetLogy(0)
            v_hists[0].SetMaximum(maximum*1.5)
            v_hists[0].SetMinimum(0.)
        else:
            pad1.SetLogy(1)
            if 'ptOverM' in varName: v_hists[0].SetMaximum(2e+5)
            else: v_hists[0].SetMaximum(2e+5)
            v_hists[0].SetMinimum(1)

        pad1.cd()
        v_hists[0].Draw("ep")
        hs.Draw("hist,same")
        h_tot.Draw("hist,same")
        h_tot_err.Draw("E2;same")
        v_hists[0].Draw("ep;same")
        pad1.RedrawAxis()
        legend.Draw("same")

        pad2.cd()
        h_ratio.Draw("ep")

        pad1.cd()
        annotate()
        output = dir_output + "/" + nameTag + "_" + scaleTag
        c1.SaveAs(output + ".png")
        c1.SaveAs(output + ".pdf")

        init_hist_collector()
    #}}}
#}}}
def run(): #{{{
    #make_composition()
    make_scale_factor()
    make_scale_factor(True)
    exit()

    plotTypes = ["yields", "normalized"]
    plotTypes = ["yields"]
    for plotType in plotTypes:
        make_plot("hHT", masses, plotType, pauseFit=False)
        #make_plot("hJet1pT", masses, plotType, pauseFit=False)
        #make_plot("hJet2pT", masses, plotType, pauseFit=False)
        #make_plot("hJet3pT", masses, plotType, pauseFit=False)
        #make_plot("hJet4pT", masses, plotType, pauseFit=False)
        #make_plot("hjet1_ptOverM", masses, plotType, pauseFit=False)
        #make_plot("hjet2_ptOverM", masses, plotType, pauseFit=False)
        #make_plot("hjet3_ptOverM", masses, plotType, pauseFit=False)
        #make_plot("hjet4_ptOverM", masses, plotType, pauseFit=False)
#}}}
if __name__ == "__main__":
    run()
    subprocess.call("ls -lhrt %s" % dir_output, shell=True)
