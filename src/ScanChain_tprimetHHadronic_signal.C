#include "ScanChain.h"
#include "chi2_helper.h"
#include "truth_matching.h"
#include "sorting.h"
#include "TMVA/Reader.h" 

int ScanChain_tprimetHHadronic_signal(TChain* chain, TString name_output_file, TString xml_file, TString mYear, TString mass_str, bool fast = true, int nEvents = -1, string skimFilePrefix = "test") {
  printf("Hello World!\n");
  name_output_file = name_output_file.ReplaceAll("hist_", "myhist_");
  //name_output_file = name_output_file.ReplaceAll("hist_", "testOnly_");
  TFile *output_file = new TFile(name_output_file, "RECREATE");
  TString currentFileTitle = name_output_file;
  TString json_file = "json/covMatrix_Era2017_M1000.json";

  TString tag = "Hadronic";
  vector<Process*> vProcess = generate_processes(output_file);
  add_variables(vProcess, tag);

  bool evaluate_mva = xml_file != "none";

  float n_lep;
  float n_jet;
  float mass_diphoton;
  float mass_top;

  // Benchmark
  TBenchmark *bmark = new TBenchmark();
  bmark->Start("benchmark");

  // Loop over events to Analyze
  unsigned int nEventsTotal = 0;
  unsigned int nEventsChain = chain->GetEntries();
  if (nEvents >= 0) nEventsChain = nEvents;
  TObjArray *listOfFiles = chain->GetListOfFiles();
  TIter fileIter(listOfFiles);
  TFile *currentFile = 0;

  // Declare BDT vars {{{
  float maxIDMVA_                 = 0.;
  float minIDMVA_                 = 0.;
  float max2_btag_                = 0.;
  float max1_btag_                = 0.;
  float dipho_delta_R             = 0.;
  float njets_                    = 0.;
  float nbjets_                   = 0.;
  float ht_                       = 0.;
  float leadptoM_                 = 0.;
  float subleadptoM_              = 0.;
  float lead_eta_                 = 0.;
  float sublead_eta_              = 0.;
  float jet1_pt_                  = 0.;
  float jet1_eta_                 = 0.;
  float jet1_btag_                = 0.;
  float jet2_pt_                  = 0.;
  float jet2_eta_                 = 0.;
  float jet2_btag_                = 0.;
  float jet3_pt_                  = 0.;
  float jet3_eta_                 = 0.;
  float jet3_btag_                = 0.;
  float jet4_pt_                  = 0.;
  float jet4_eta_                 = 0.;
  float jet4_btag_                = 0.;
  float leadPSV_                  = 0.;
  float subleadPSV_               = 0.;
  float dipho_cosphi_             = 0.;
  float dipho_rapidity_           = 0.;
  float met_                      = 0.;
  float dipho_pt_over_mass_       = 0.;
  float helicity_angle_           = 0.;
  float chi2_value_               = 0.;
  float chi2_bjet_pt_             = 0.;
  float chi2_wjet1_pt_            = 0.;
  float chi2_wjet2_pt_            = 0.;
  float chi2_bjet_eta_            = 0.;
  float chi2_wjet1_eta_           = 0.;
  float chi2_wjet2_eta_           = 0.;
  float chi2_wjets_deltaR_        = 0.;
  float chi2_wboson_pt_           = 0.;
  float chi2_wboson_eta_          = 0.;
  float chi2_wboson_mass_         = 0.;
  float chi2_wboson_deltaR_bjet_  = 0.;
  float chi2_tbw_mass_            = 0.;
  float chi2_tbw_pt_              = 0.;
  float chi2_tbw_eta_             = 0.;
  float chi2_tbw_deltaR_dipho_    = 0.;
  float chi2_tprime_ptOverM_      = 0.;
  float chi2_tprime_eta_          = 0.;
  float chi2_tprime_deltaR_tbw_   = 0.;
  float chi2_tprime_deltaR_dipho_ = 0.;
  float chi2_bjet_btagScores_     = 0.;
  float chi2_wjet1_btagScores_    = 0.;
  float chi2_wjet2_btagScores_    = 0.;
  float tprime_pt_ratio_          = 0.;
  float chi2_bjet_ptOverM_        = 0.;
  float chi2_wjet1_ptOverM_       = 0.;
  float chi2_wjet2_ptOverM_       = 0.;
  float chi2_wboson_ptOverM_      = 0.;
  float chi2_tbw_ptOverM_         = 0.;
  float helicity_tprime_          = 0.;
  float jet1_ptOverM_             = 0.;
  float jet2_ptOverM_             = 0.;
  float jet3_ptOverM_             = 0.;
  float jet4_ptOverM_             = 0.;
  //}}}

  unique_ptr<TMVA::Reader> mva;
  unique_ptr<TMVA::Reader> mva_nrb_m600;
  unique_ptr<TMVA::Reader> mva_smh_m600;
  unique_ptr<TMVA::Reader> mva_smhnrb_m600;
  unique_ptr<TMVA::Reader> mva_smh_varset8_m600;
  unique_ptr<TMVA::Reader> mva_smh_varset8_m625;
  unique_ptr<TMVA::Reader> mva_smh_varset8_m650;
  unique_ptr<TMVA::Reader> mva_smh_varset8_m675;
  unique_ptr<TMVA::Reader> mva_smh_varset8_m700;
  unique_ptr<TMVA::Reader> mva_smh_varset8_m800;
  unique_ptr<TMVA::Reader> mva_smh_varset8_m900;
  unique_ptr<TMVA::Reader> mva_smh_varset8_m1000;
  unique_ptr<TMVA::Reader> mva_smh_varset8_m1100;
  unique_ptr<TMVA::Reader> mva_smh_varset8_m1200;
  unique_ptr<TMVA::Reader> mva_smh_varset8_mixed01;
  unique_ptr<TMVA::Reader> mva_smh_varset8_mixed02;
  unique_ptr<TMVA::Reader> mva_smh_varset8_mixed03;
  unique_ptr<TMVA::Reader> mva_smh_varset8_mixed04;
  unique_ptr<TMVA::Reader> mva_smh_varset8_mixed05;

  if (evaluate_mva) {
    // mva very beginning version {{{
    mva.reset(new TMVA::Reader( "!Color:Silent" ));

	mva->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva->AddVariable("max2_btag_"                , &max2_btag_                );
	mva->AddVariable("max1_btag_"                , &max1_btag_                );
	mva->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva->AddVariable("njets_"                    , &njets_                    );
	mva->AddVariable("ht_"                       , &ht_                       );
	mva->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva->AddVariable("jet1_pt_"                  , &jet1_pt_                  );
	mva->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva->AddVariable("jet2_pt_"                  , &jet2_pt_                  );
	mva->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva->AddVariable("jet3_pt_"                  , &jet3_pt_                  );
	mva->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva->AddVariable("jet4_pt_"                  , &jet4_pt_                  );
	mva->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva->AddVariable("met_"                      , &met_                      );
	mva->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva->AddVariable("chi2_value_"               , &chi2_value_               );
	mva->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva->AddVariable("chi2_tbw_pt_"              , &chi2_tbw_pt_              );
	mva->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva->AddVariable("chi2_tbw_deltaR_dipho_"    , &chi2_tbw_deltaR_dipho_    );
	mva->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva->AddVariable("chi2_tprime_deltaR_tbw_"   , &chi2_tprime_deltaR_tbw_   );
	mva->AddVariable("chi2_tprime_deltaR_dipho_" , &chi2_tprime_deltaR_dipho_ );
	mva->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );

    mva->BookMVA("BDT", xml_file);
    //}}}
    // mva_nrb_m600{{{
    mva_nrb_m600.reset(new TMVA::Reader( "!Color:Silent" ));
	mva_nrb_m600->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva_nrb_m600->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva_nrb_m600->AddVariable("max1_btag_"                , &max1_btag_                );
	mva_nrb_m600->AddVariable("max2_btag_"                , &max2_btag_                );
	mva_nrb_m600->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva_nrb_m600->AddVariable("njets_"                    , &njets_                    );
	mva_nrb_m600->AddVariable("nbjets_"                   , &nbjets_                   );
	mva_nrb_m600->AddVariable("ht_"                       , &ht_                       );
	mva_nrb_m600->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva_nrb_m600->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva_nrb_m600->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva_nrb_m600->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva_nrb_m600->AddVariable("jet1_ptOverM_"             , &jet1_ptOverM_             );
	mva_nrb_m600->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva_nrb_m600->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva_nrb_m600->AddVariable("jet2_ptOverM_"             , &jet2_ptOverM_             );
	mva_nrb_m600->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva_nrb_m600->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva_nrb_m600->AddVariable("jet3_ptOverM_"             , &jet3_ptOverM_             );
	mva_nrb_m600->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva_nrb_m600->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva_nrb_m600->AddVariable("jet4_ptOverM_"             , &jet4_ptOverM_             );
	mva_nrb_m600->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva_nrb_m600->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva_nrb_m600->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva_nrb_m600->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva_nrb_m600->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva_nrb_m600->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva_nrb_m600->AddVariable("met_"                      , &met_                      );
	mva_nrb_m600->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva_nrb_m600->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva_nrb_m600->AddVariable("chi2_value_"               , &chi2_value_               );
	mva_nrb_m600->AddVariable("chi2_bjet_ptOverM_"        , &chi2_bjet_ptOverM_        );
	mva_nrb_m600->AddVariable("chi2_bjet_eta_"            , &chi2_bjet_eta_            );
	mva_nrb_m600->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva_nrb_m600->AddVariable("chi2_wjet1_ptOverM_"       , &chi2_wjet1_ptOverM_       );
	mva_nrb_m600->AddVariable("chi2_wjet1_eta_"           , &chi2_wjet1_eta_           );
	mva_nrb_m600->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva_nrb_m600->AddVariable("chi2_wjet2_ptOverM_"       , &chi2_wjet2_ptOverM_       );
	mva_nrb_m600->AddVariable("chi2_wjet2_eta_"           , &chi2_wjet2_eta_           );
	mva_nrb_m600->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );
	mva_nrb_m600->AddVariable("chi2_wjets_deltaR_"        , &chi2_wjets_deltaR_        );
	mva_nrb_m600->AddVariable("chi2_wboson_ptOverM_"      , &chi2_wboson_ptOverM_      );
	mva_nrb_m600->AddVariable("chi2_wboson_eta_"          , &chi2_wboson_eta_          );
	mva_nrb_m600->AddVariable("chi2_wboson_mass_"         , &chi2_wboson_mass_         );
	mva_nrb_m600->AddVariable("chi2_wboson_deltaR_bjet_"  , &chi2_wboson_deltaR_bjet_  );
	mva_nrb_m600->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva_nrb_m600->AddVariable("chi2_tbw_ptOverM_"         , &chi2_tbw_ptOverM_         );
	mva_nrb_m600->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva_nrb_m600->AddVariable("chi2_tbw_deltaR_dipho_"    , &chi2_tbw_deltaR_dipho_    );
	mva_nrb_m600->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva_nrb_m600->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva_nrb_m600->AddVariable("chi2_tprime_deltaR_tbw_"   , &chi2_tprime_deltaR_tbw_   );
	mva_nrb_m600->AddVariable("chi2_tprime_deltaR_dipho_" , &chi2_tprime_deltaR_dipho_ );
	mva_nrb_m600->AddVariable("tprime_pt_ratio_"          , &tprime_pt_ratio_          );
    mva_nrb_m600->BookMVA("BDT", "./mva/Hadronic_tprime_NRB_varSet2_sigM600_bdt.xml");
    //}}}
    // mva_smh_m600{{{
    mva_smh_m600.reset(new TMVA::Reader( "!Color:Silent" ));
	mva_smh_m600->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva_smh_m600->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva_smh_m600->AddVariable("max1_btag_"                , &max1_btag_                );
	mva_smh_m600->AddVariable("max2_btag_"                , &max2_btag_                );
	mva_smh_m600->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva_smh_m600->AddVariable("njets_"                    , &njets_                    );
	mva_smh_m600->AddVariable("nbjets_"                   , &nbjets_                   );
	mva_smh_m600->AddVariable("ht_"                       , &ht_                       );
	mva_smh_m600->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva_smh_m600->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva_smh_m600->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva_smh_m600->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva_smh_m600->AddVariable("jet1_ptOverM_"             , &jet1_ptOverM_             );
	mva_smh_m600->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva_smh_m600->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva_smh_m600->AddVariable("jet2_ptOverM_"             , &jet2_ptOverM_             );
	mva_smh_m600->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva_smh_m600->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva_smh_m600->AddVariable("jet3_ptOverM_"             , &jet3_ptOverM_             );
	mva_smh_m600->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva_smh_m600->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva_smh_m600->AddVariable("jet4_ptOverM_"             , &jet4_ptOverM_             );
	mva_smh_m600->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva_smh_m600->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva_smh_m600->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva_smh_m600->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva_smh_m600->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva_smh_m600->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva_smh_m600->AddVariable("met_"                      , &met_                      );
	mva_smh_m600->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva_smh_m600->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva_smh_m600->AddVariable("chi2_value_"               , &chi2_value_               );
	mva_smh_m600->AddVariable("chi2_bjet_ptOverM_"        , &chi2_bjet_ptOverM_        );
	mva_smh_m600->AddVariable("chi2_bjet_eta_"            , &chi2_bjet_eta_            );
	mva_smh_m600->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva_smh_m600->AddVariable("chi2_wjet1_ptOverM_"       , &chi2_wjet1_ptOverM_       );
	mva_smh_m600->AddVariable("chi2_wjet1_eta_"           , &chi2_wjet1_eta_           );
	mva_smh_m600->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva_smh_m600->AddVariable("chi2_wjet2_ptOverM_"       , &chi2_wjet2_ptOverM_       );
	mva_smh_m600->AddVariable("chi2_wjet2_eta_"           , &chi2_wjet2_eta_           );
	mva_smh_m600->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );
	mva_smh_m600->AddVariable("chi2_wjets_deltaR_"        , &chi2_wjets_deltaR_        );
	mva_smh_m600->AddVariable("chi2_wboson_ptOverM_"      , &chi2_wboson_ptOverM_      );
	mva_smh_m600->AddVariable("chi2_wboson_eta_"          , &chi2_wboson_eta_          );
	mva_smh_m600->AddVariable("chi2_wboson_mass_"         , &chi2_wboson_mass_         );
	mva_smh_m600->AddVariable("chi2_wboson_deltaR_bjet_"  , &chi2_wboson_deltaR_bjet_  );
	mva_smh_m600->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva_smh_m600->AddVariable("chi2_tbw_ptOverM_"         , &chi2_tbw_ptOverM_         );
	mva_smh_m600->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva_smh_m600->AddVariable("chi2_tbw_deltaR_dipho_"    , &chi2_tbw_deltaR_dipho_    );
	mva_smh_m600->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva_smh_m600->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva_smh_m600->AddVariable("chi2_tprime_deltaR_tbw_"   , &chi2_tprime_deltaR_tbw_   );
	mva_smh_m600->AddVariable("chi2_tprime_deltaR_dipho_" , &chi2_tprime_deltaR_dipho_ );
	mva_smh_m600->AddVariable("tprime_pt_ratio_"          , &tprime_pt_ratio_          );
    mva_smh_m600->BookMVA("BDT", "./mva/Hadronic_tprime_SMH_varSet2_sigM600_bdt.xml");
    //}}}
    // mva_smhnrb_m600{{{
    mva_smhnrb_m600.reset(new TMVA::Reader( "!Color:Silent" ));
	mva_smhnrb_m600->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva_smhnrb_m600->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva_smhnrb_m600->AddVariable("max1_btag_"                , &max1_btag_                );
	mva_smhnrb_m600->AddVariable("max2_btag_"                , &max2_btag_                );
	mva_smhnrb_m600->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva_smhnrb_m600->AddVariable("njets_"                    , &njets_                    );
	mva_smhnrb_m600->AddVariable("nbjets_"                   , &nbjets_                   );
	mva_smhnrb_m600->AddVariable("ht_"                       , &ht_                       );
	mva_smhnrb_m600->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva_smhnrb_m600->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva_smhnrb_m600->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva_smhnrb_m600->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva_smhnrb_m600->AddVariable("jet1_ptOverM_"             , &jet1_ptOverM_             );
	mva_smhnrb_m600->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva_smhnrb_m600->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva_smhnrb_m600->AddVariable("jet2_ptOverM_"             , &jet2_ptOverM_             );
	mva_smhnrb_m600->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva_smhnrb_m600->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva_smhnrb_m600->AddVariable("jet3_ptOverM_"             , &jet3_ptOverM_             );
	mva_smhnrb_m600->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva_smhnrb_m600->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva_smhnrb_m600->AddVariable("jet4_ptOverM_"             , &jet4_ptOverM_             );
	mva_smhnrb_m600->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva_smhnrb_m600->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva_smhnrb_m600->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva_smhnrb_m600->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva_smhnrb_m600->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva_smhnrb_m600->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva_smhnrb_m600->AddVariable("met_"                      , &met_                      );
	mva_smhnrb_m600->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva_smhnrb_m600->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva_smhnrb_m600->AddVariable("chi2_value_"               , &chi2_value_               );
	mva_smhnrb_m600->AddVariable("chi2_bjet_ptOverM_"        , &chi2_bjet_ptOverM_        );
	mva_smhnrb_m600->AddVariable("chi2_bjet_eta_"            , &chi2_bjet_eta_            );
	mva_smhnrb_m600->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva_smhnrb_m600->AddVariable("chi2_wjet1_ptOverM_"       , &chi2_wjet1_ptOverM_       );
	mva_smhnrb_m600->AddVariable("chi2_wjet1_eta_"           , &chi2_wjet1_eta_           );
	mva_smhnrb_m600->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva_smhnrb_m600->AddVariable("chi2_wjet2_ptOverM_"       , &chi2_wjet2_ptOverM_       );
	mva_smhnrb_m600->AddVariable("chi2_wjet2_eta_"           , &chi2_wjet2_eta_           );
	mva_smhnrb_m600->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );
	mva_smhnrb_m600->AddVariable("chi2_wjets_deltaR_"        , &chi2_wjets_deltaR_        );
	mva_smhnrb_m600->AddVariable("chi2_wboson_ptOverM_"      , &chi2_wboson_ptOverM_      );
	mva_smhnrb_m600->AddVariable("chi2_wboson_eta_"          , &chi2_wboson_eta_          );
	mva_smhnrb_m600->AddVariable("chi2_wboson_mass_"         , &chi2_wboson_mass_         );
	mva_smhnrb_m600->AddVariable("chi2_wboson_deltaR_bjet_"  , &chi2_wboson_deltaR_bjet_  );
	mva_smhnrb_m600->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva_smhnrb_m600->AddVariable("chi2_tbw_ptOverM_"         , &chi2_tbw_ptOverM_         );
	mva_smhnrb_m600->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva_smhnrb_m600->AddVariable("chi2_tbw_deltaR_dipho_"    , &chi2_tbw_deltaR_dipho_    );
	mva_smhnrb_m600->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva_smhnrb_m600->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva_smhnrb_m600->AddVariable("chi2_tprime_deltaR_tbw_"   , &chi2_tprime_deltaR_tbw_   );
	mva_smhnrb_m600->AddVariable("chi2_tprime_deltaR_dipho_" , &chi2_tprime_deltaR_dipho_ );
	mva_smhnrb_m600->AddVariable("tprime_pt_ratio_"          , &tprime_pt_ratio_          );
    mva_smhnrb_m600->BookMVA("BDT", "./mva/Hadronic_tprime_SMHNRB_varSet2_sigM600_bdt.xml");
    //}}}
    // mva_smh_varset8_m600{{{
    mva_smh_varset8_m600.reset(new TMVA::Reader( "!Color:Silent" ));
	mva_smh_varset8_m600->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva_smh_varset8_m600->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva_smh_varset8_m600->AddVariable("max1_btag_"                , &max1_btag_                );
	mva_smh_varset8_m600->AddVariable("max2_btag_"                , &max2_btag_                );
	mva_smh_varset8_m600->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva_smh_varset8_m600->AddVariable("njets_"                    , &njets_                    );
	mva_smh_varset8_m600->AddVariable("nbjets_"                   , &nbjets_                   );
	mva_smh_varset8_m600->AddVariable("ht_"                       , &ht_                       );
	mva_smh_varset8_m600->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva_smh_varset8_m600->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva_smh_varset8_m600->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva_smh_varset8_m600->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva_smh_varset8_m600->AddVariable("jet1_ptOverM_"             , &jet1_ptOverM_             );
	mva_smh_varset8_m600->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva_smh_varset8_m600->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva_smh_varset8_m600->AddVariable("jet2_ptOverM_"             , &jet2_ptOverM_             );
	mva_smh_varset8_m600->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva_smh_varset8_m600->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva_smh_varset8_m600->AddVariable("jet3_ptOverM_"             , &jet3_ptOverM_             );
	mva_smh_varset8_m600->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva_smh_varset8_m600->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva_smh_varset8_m600->AddVariable("jet4_ptOverM_"             , &jet4_ptOverM_             );
	mva_smh_varset8_m600->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva_smh_varset8_m600->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva_smh_varset8_m600->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva_smh_varset8_m600->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva_smh_varset8_m600->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva_smh_varset8_m600->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva_smh_varset8_m600->AddVariable("met_"                      , &met_                      );
	mva_smh_varset8_m600->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva_smh_varset8_m600->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva_smh_varset8_m600->AddVariable("chi2_value_"               , &chi2_value_               );
	mva_smh_varset8_m600->AddVariable("chi2_bjet_ptOverM_"        , &chi2_bjet_ptOverM_        );
	mva_smh_varset8_m600->AddVariable("chi2_bjet_eta_"            , &chi2_bjet_eta_            );
	mva_smh_varset8_m600->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva_smh_varset8_m600->AddVariable("chi2_wjet1_ptOverM_"       , &chi2_wjet1_ptOverM_       );
	mva_smh_varset8_m600->AddVariable("chi2_wjet1_eta_"           , &chi2_wjet1_eta_           );
	mva_smh_varset8_m600->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva_smh_varset8_m600->AddVariable("chi2_wjet2_ptOverM_"       , &chi2_wjet2_ptOverM_       );
	mva_smh_varset8_m600->AddVariable("chi2_wjet2_eta_"           , &chi2_wjet2_eta_           );
	mva_smh_varset8_m600->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );
	mva_smh_varset8_m600->AddVariable("chi2_wjets_deltaR_"        , &chi2_wjets_deltaR_        );
	mva_smh_varset8_m600->AddVariable("chi2_wboson_ptOverM_"      , &chi2_wboson_ptOverM_      );
	mva_smh_varset8_m600->AddVariable("chi2_wboson_eta_"          , &chi2_wboson_eta_          );
	mva_smh_varset8_m600->AddVariable("chi2_wboson_mass_"         , &chi2_wboson_mass_         );
	mva_smh_varset8_m600->AddVariable("chi2_wboson_deltaR_bjet_"  , &chi2_wboson_deltaR_bjet_  );
	mva_smh_varset8_m600->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva_smh_varset8_m600->AddVariable("chi2_tbw_ptOverM_"         , &chi2_tbw_ptOverM_         );
	mva_smh_varset8_m600->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva_smh_varset8_m600->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva_smh_varset8_m600->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva_smh_varset8_m600->AddVariable("tprime_pt_ratio_"          , &tprime_pt_ratio_          );
	mva_smh_varset8_m600->AddVariable("helicity_tprime_"          , &helicity_tprime_          );
    mva_smh_varset8_m600->BookMVA("BDT", "./mva/Hadronic_tprime_SMH_varSet8_sigM600_bdt.xml");
    //}}}
    // mva_smh_varset8_m625{{{
    mva_smh_varset8_m625.reset(new TMVA::Reader( "!Color:Silent" ));
	mva_smh_varset8_m625->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva_smh_varset8_m625->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva_smh_varset8_m625->AddVariable("max1_btag_"                , &max1_btag_                );
	mva_smh_varset8_m625->AddVariable("max2_btag_"                , &max2_btag_                );
	mva_smh_varset8_m625->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva_smh_varset8_m625->AddVariable("njets_"                    , &njets_                    );
	mva_smh_varset8_m625->AddVariable("nbjets_"                   , &nbjets_                   );
	mva_smh_varset8_m625->AddVariable("ht_"                       , &ht_                       );
	mva_smh_varset8_m625->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva_smh_varset8_m625->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva_smh_varset8_m625->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva_smh_varset8_m625->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva_smh_varset8_m625->AddVariable("jet1_ptOverM_"             , &jet1_ptOverM_             );
	mva_smh_varset8_m625->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva_smh_varset8_m625->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva_smh_varset8_m625->AddVariable("jet2_ptOverM_"             , &jet2_ptOverM_             );
	mva_smh_varset8_m625->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva_smh_varset8_m625->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva_smh_varset8_m625->AddVariable("jet3_ptOverM_"             , &jet3_ptOverM_             );
	mva_smh_varset8_m625->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva_smh_varset8_m625->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva_smh_varset8_m625->AddVariable("jet4_ptOverM_"             , &jet4_ptOverM_             );
	mva_smh_varset8_m625->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva_smh_varset8_m625->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva_smh_varset8_m625->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva_smh_varset8_m625->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva_smh_varset8_m625->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva_smh_varset8_m625->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva_smh_varset8_m625->AddVariable("met_"                      , &met_                      );
	mva_smh_varset8_m625->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva_smh_varset8_m625->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva_smh_varset8_m625->AddVariable("chi2_value_"               , &chi2_value_               );
	mva_smh_varset8_m625->AddVariable("chi2_bjet_ptOverM_"        , &chi2_bjet_ptOverM_        );
	mva_smh_varset8_m625->AddVariable("chi2_bjet_eta_"            , &chi2_bjet_eta_            );
	mva_smh_varset8_m625->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva_smh_varset8_m625->AddVariable("chi2_wjet1_ptOverM_"       , &chi2_wjet1_ptOverM_       );
	mva_smh_varset8_m625->AddVariable("chi2_wjet1_eta_"           , &chi2_wjet1_eta_           );
	mva_smh_varset8_m625->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva_smh_varset8_m625->AddVariable("chi2_wjet2_ptOverM_"       , &chi2_wjet2_ptOverM_       );
	mva_smh_varset8_m625->AddVariable("chi2_wjet2_eta_"           , &chi2_wjet2_eta_           );
	mva_smh_varset8_m625->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );
	mva_smh_varset8_m625->AddVariable("chi2_wjets_deltaR_"        , &chi2_wjets_deltaR_        );
	mva_smh_varset8_m625->AddVariable("chi2_wboson_ptOverM_"      , &chi2_wboson_ptOverM_      );
	mva_smh_varset8_m625->AddVariable("chi2_wboson_eta_"          , &chi2_wboson_eta_          );
	mva_smh_varset8_m625->AddVariable("chi2_wboson_mass_"         , &chi2_wboson_mass_         );
	mva_smh_varset8_m625->AddVariable("chi2_wboson_deltaR_bjet_"  , &chi2_wboson_deltaR_bjet_  );
	mva_smh_varset8_m625->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva_smh_varset8_m625->AddVariable("chi2_tbw_ptOverM_"         , &chi2_tbw_ptOverM_         );
	mva_smh_varset8_m625->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva_smh_varset8_m625->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva_smh_varset8_m625->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva_smh_varset8_m625->AddVariable("tprime_pt_ratio_"          , &tprime_pt_ratio_          );
	mva_smh_varset8_m625->AddVariable("helicity_tprime_"          , &helicity_tprime_          );
    mva_smh_varset8_m625->BookMVA("BDT", "./mva/Hadronic_tprime_SMH_varSet8_sigM625_bdt.xml");
    //}}}
    // mva_smh_varset8_m650{{{
    mva_smh_varset8_m650.reset(new TMVA::Reader( "!Color:Silent" ));
	mva_smh_varset8_m650->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva_smh_varset8_m650->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva_smh_varset8_m650->AddVariable("max1_btag_"                , &max1_btag_                );
	mva_smh_varset8_m650->AddVariable("max2_btag_"                , &max2_btag_                );
	mva_smh_varset8_m650->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva_smh_varset8_m650->AddVariable("njets_"                    , &njets_                    );
	mva_smh_varset8_m650->AddVariable("nbjets_"                   , &nbjets_                   );
	mva_smh_varset8_m650->AddVariable("ht_"                       , &ht_                       );
	mva_smh_varset8_m650->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva_smh_varset8_m650->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva_smh_varset8_m650->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva_smh_varset8_m650->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva_smh_varset8_m650->AddVariable("jet1_ptOverM_"             , &jet1_ptOverM_             );
	mva_smh_varset8_m650->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva_smh_varset8_m650->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva_smh_varset8_m650->AddVariable("jet2_ptOverM_"             , &jet2_ptOverM_             );
	mva_smh_varset8_m650->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva_smh_varset8_m650->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva_smh_varset8_m650->AddVariable("jet3_ptOverM_"             , &jet3_ptOverM_             );
	mva_smh_varset8_m650->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva_smh_varset8_m650->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva_smh_varset8_m650->AddVariable("jet4_ptOverM_"             , &jet4_ptOverM_             );
	mva_smh_varset8_m650->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva_smh_varset8_m650->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva_smh_varset8_m650->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva_smh_varset8_m650->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva_smh_varset8_m650->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva_smh_varset8_m650->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva_smh_varset8_m650->AddVariable("met_"                      , &met_                      );
	mva_smh_varset8_m650->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva_smh_varset8_m650->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva_smh_varset8_m650->AddVariable("chi2_value_"               , &chi2_value_               );
	mva_smh_varset8_m650->AddVariable("chi2_bjet_ptOverM_"        , &chi2_bjet_ptOverM_        );
	mva_smh_varset8_m650->AddVariable("chi2_bjet_eta_"            , &chi2_bjet_eta_            );
	mva_smh_varset8_m650->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva_smh_varset8_m650->AddVariable("chi2_wjet1_ptOverM_"       , &chi2_wjet1_ptOverM_       );
	mva_smh_varset8_m650->AddVariable("chi2_wjet1_eta_"           , &chi2_wjet1_eta_           );
	mva_smh_varset8_m650->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva_smh_varset8_m650->AddVariable("chi2_wjet2_ptOverM_"       , &chi2_wjet2_ptOverM_       );
	mva_smh_varset8_m650->AddVariable("chi2_wjet2_eta_"           , &chi2_wjet2_eta_           );
	mva_smh_varset8_m650->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );
	mva_smh_varset8_m650->AddVariable("chi2_wjets_deltaR_"        , &chi2_wjets_deltaR_        );
	mva_smh_varset8_m650->AddVariable("chi2_wboson_ptOverM_"      , &chi2_wboson_ptOverM_      );
	mva_smh_varset8_m650->AddVariable("chi2_wboson_eta_"          , &chi2_wboson_eta_          );
	mva_smh_varset8_m650->AddVariable("chi2_wboson_mass_"         , &chi2_wboson_mass_         );
	mva_smh_varset8_m650->AddVariable("chi2_wboson_deltaR_bjet_"  , &chi2_wboson_deltaR_bjet_  );
	mva_smh_varset8_m650->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva_smh_varset8_m650->AddVariable("chi2_tbw_ptOverM_"         , &chi2_tbw_ptOverM_         );
	mva_smh_varset8_m650->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva_smh_varset8_m650->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva_smh_varset8_m650->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva_smh_varset8_m650->AddVariable("tprime_pt_ratio_"          , &tprime_pt_ratio_          );
	mva_smh_varset8_m650->AddVariable("helicity_tprime_"          , &helicity_tprime_          );
    mva_smh_varset8_m650->BookMVA("BDT", "./mva/Hadronic_tprime_SMH_varSet8_sigM650_bdt.xml");
    //}}}
    // mva_smh_varset8_m675{{{
    mva_smh_varset8_m675.reset(new TMVA::Reader( "!Color:Silent" ));
	mva_smh_varset8_m675->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva_smh_varset8_m675->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva_smh_varset8_m675->AddVariable("max1_btag_"                , &max1_btag_                );
	mva_smh_varset8_m675->AddVariable("max2_btag_"                , &max2_btag_                );
	mva_smh_varset8_m675->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva_smh_varset8_m675->AddVariable("njets_"                    , &njets_                    );
	mva_smh_varset8_m675->AddVariable("nbjets_"                   , &nbjets_                   );
	mva_smh_varset8_m675->AddVariable("ht_"                       , &ht_                       );
	mva_smh_varset8_m675->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva_smh_varset8_m675->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva_smh_varset8_m675->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva_smh_varset8_m675->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva_smh_varset8_m675->AddVariable("jet1_ptOverM_"             , &jet1_ptOverM_             );
	mva_smh_varset8_m675->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva_smh_varset8_m675->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva_smh_varset8_m675->AddVariable("jet2_ptOverM_"             , &jet2_ptOverM_             );
	mva_smh_varset8_m675->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva_smh_varset8_m675->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva_smh_varset8_m675->AddVariable("jet3_ptOverM_"             , &jet3_ptOverM_             );
	mva_smh_varset8_m675->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva_smh_varset8_m675->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva_smh_varset8_m675->AddVariable("jet4_ptOverM_"             , &jet4_ptOverM_             );
	mva_smh_varset8_m675->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva_smh_varset8_m675->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva_smh_varset8_m675->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva_smh_varset8_m675->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva_smh_varset8_m675->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva_smh_varset8_m675->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva_smh_varset8_m675->AddVariable("met_"                      , &met_                      );
	mva_smh_varset8_m675->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva_smh_varset8_m675->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva_smh_varset8_m675->AddVariable("chi2_value_"               , &chi2_value_               );
	mva_smh_varset8_m675->AddVariable("chi2_bjet_ptOverM_"        , &chi2_bjet_ptOverM_        );
	mva_smh_varset8_m675->AddVariable("chi2_bjet_eta_"            , &chi2_bjet_eta_            );
	mva_smh_varset8_m675->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva_smh_varset8_m675->AddVariable("chi2_wjet1_ptOverM_"       , &chi2_wjet1_ptOverM_       );
	mva_smh_varset8_m675->AddVariable("chi2_wjet1_eta_"           , &chi2_wjet1_eta_           );
	mva_smh_varset8_m675->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva_smh_varset8_m675->AddVariable("chi2_wjet2_ptOverM_"       , &chi2_wjet2_ptOverM_       );
	mva_smh_varset8_m675->AddVariable("chi2_wjet2_eta_"           , &chi2_wjet2_eta_           );
	mva_smh_varset8_m675->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );
	mva_smh_varset8_m675->AddVariable("chi2_wjets_deltaR_"        , &chi2_wjets_deltaR_        );
	mva_smh_varset8_m675->AddVariable("chi2_wboson_ptOverM_"      , &chi2_wboson_ptOverM_      );
	mva_smh_varset8_m675->AddVariable("chi2_wboson_eta_"          , &chi2_wboson_eta_          );
	mva_smh_varset8_m675->AddVariable("chi2_wboson_mass_"         , &chi2_wboson_mass_         );
	mva_smh_varset8_m675->AddVariable("chi2_wboson_deltaR_bjet_"  , &chi2_wboson_deltaR_bjet_  );
	mva_smh_varset8_m675->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva_smh_varset8_m675->AddVariable("chi2_tbw_ptOverM_"         , &chi2_tbw_ptOverM_         );
	mva_smh_varset8_m675->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva_smh_varset8_m675->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva_smh_varset8_m675->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva_smh_varset8_m675->AddVariable("tprime_pt_ratio_"          , &tprime_pt_ratio_          );
	mva_smh_varset8_m675->AddVariable("helicity_tprime_"          , &helicity_tprime_          );
    mva_smh_varset8_m675->BookMVA("BDT", "./mva/Hadronic_tprime_SMH_varSet8_sigM675_bdt.xml");
    //}}}
    // mva_smh_varset8_m700{{{
    mva_smh_varset8_m700.reset(new TMVA::Reader( "!Color:Silent" ));
	mva_smh_varset8_m700->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva_smh_varset8_m700->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva_smh_varset8_m700->AddVariable("max1_btag_"                , &max1_btag_                );
	mva_smh_varset8_m700->AddVariable("max2_btag_"                , &max2_btag_                );
	mva_smh_varset8_m700->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva_smh_varset8_m700->AddVariable("njets_"                    , &njets_                    );
	mva_smh_varset8_m700->AddVariable("nbjets_"                   , &nbjets_                   );
	mva_smh_varset8_m700->AddVariable("ht_"                       , &ht_                       );
	mva_smh_varset8_m700->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva_smh_varset8_m700->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva_smh_varset8_m700->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva_smh_varset8_m700->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva_smh_varset8_m700->AddVariable("jet1_ptOverM_"             , &jet1_ptOverM_             );
	mva_smh_varset8_m700->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva_smh_varset8_m700->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva_smh_varset8_m700->AddVariable("jet2_ptOverM_"             , &jet2_ptOverM_             );
	mva_smh_varset8_m700->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva_smh_varset8_m700->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva_smh_varset8_m700->AddVariable("jet3_ptOverM_"             , &jet3_ptOverM_             );
	mva_smh_varset8_m700->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva_smh_varset8_m700->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva_smh_varset8_m700->AddVariable("jet4_ptOverM_"             , &jet4_ptOverM_             );
	mva_smh_varset8_m700->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva_smh_varset8_m700->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva_smh_varset8_m700->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva_smh_varset8_m700->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva_smh_varset8_m700->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva_smh_varset8_m700->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva_smh_varset8_m700->AddVariable("met_"                      , &met_                      );
	mva_smh_varset8_m700->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva_smh_varset8_m700->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva_smh_varset8_m700->AddVariable("chi2_value_"               , &chi2_value_               );
	mva_smh_varset8_m700->AddVariable("chi2_bjet_ptOverM_"        , &chi2_bjet_ptOverM_        );
	mva_smh_varset8_m700->AddVariable("chi2_bjet_eta_"            , &chi2_bjet_eta_            );
	mva_smh_varset8_m700->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva_smh_varset8_m700->AddVariable("chi2_wjet1_ptOverM_"       , &chi2_wjet1_ptOverM_       );
	mva_smh_varset8_m700->AddVariable("chi2_wjet1_eta_"           , &chi2_wjet1_eta_           );
	mva_smh_varset8_m700->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva_smh_varset8_m700->AddVariable("chi2_wjet2_ptOverM_"       , &chi2_wjet2_ptOverM_       );
	mva_smh_varset8_m700->AddVariable("chi2_wjet2_eta_"           , &chi2_wjet2_eta_           );
	mva_smh_varset8_m700->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );
	mva_smh_varset8_m700->AddVariable("chi2_wjets_deltaR_"        , &chi2_wjets_deltaR_        );
	mva_smh_varset8_m700->AddVariable("chi2_wboson_ptOverM_"      , &chi2_wboson_ptOverM_      );
	mva_smh_varset8_m700->AddVariable("chi2_wboson_eta_"          , &chi2_wboson_eta_          );
	mva_smh_varset8_m700->AddVariable("chi2_wboson_mass_"         , &chi2_wboson_mass_         );
	mva_smh_varset8_m700->AddVariable("chi2_wboson_deltaR_bjet_"  , &chi2_wboson_deltaR_bjet_  );
	mva_smh_varset8_m700->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva_smh_varset8_m700->AddVariable("chi2_tbw_ptOverM_"         , &chi2_tbw_ptOverM_         );
	mva_smh_varset8_m700->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva_smh_varset8_m700->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva_smh_varset8_m700->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva_smh_varset8_m700->AddVariable("tprime_pt_ratio_"          , &tprime_pt_ratio_          );
	mva_smh_varset8_m700->AddVariable("helicity_tprime_"          , &helicity_tprime_          );
    mva_smh_varset8_m700->BookMVA("BDT", "./mva/Hadronic_tprime_SMH_varSet8_sigM700_bdt.xml");
    //}}}
    // mva_smh_varset8_m800{{{
    mva_smh_varset8_m800.reset(new TMVA::Reader( "!Color:Silent" ));
	mva_smh_varset8_m800->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva_smh_varset8_m800->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva_smh_varset8_m800->AddVariable("max1_btag_"                , &max1_btag_                );
	mva_smh_varset8_m800->AddVariable("max2_btag_"                , &max2_btag_                );
	mva_smh_varset8_m800->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva_smh_varset8_m800->AddVariable("njets_"                    , &njets_                    );
	mva_smh_varset8_m800->AddVariable("nbjets_"                   , &nbjets_                   );
	mva_smh_varset8_m800->AddVariable("ht_"                       , &ht_                       );
	mva_smh_varset8_m800->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva_smh_varset8_m800->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva_smh_varset8_m800->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva_smh_varset8_m800->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva_smh_varset8_m800->AddVariable("jet1_ptOverM_"             , &jet1_ptOverM_             );
	mva_smh_varset8_m800->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva_smh_varset8_m800->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva_smh_varset8_m800->AddVariable("jet2_ptOverM_"             , &jet2_ptOverM_             );
	mva_smh_varset8_m800->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva_smh_varset8_m800->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva_smh_varset8_m800->AddVariable("jet3_ptOverM_"             , &jet3_ptOverM_             );
	mva_smh_varset8_m800->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva_smh_varset8_m800->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva_smh_varset8_m800->AddVariable("jet4_ptOverM_"             , &jet4_ptOverM_             );
	mva_smh_varset8_m800->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva_smh_varset8_m800->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva_smh_varset8_m800->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva_smh_varset8_m800->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva_smh_varset8_m800->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva_smh_varset8_m800->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva_smh_varset8_m800->AddVariable("met_"                      , &met_                      );
	mva_smh_varset8_m800->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva_smh_varset8_m800->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva_smh_varset8_m800->AddVariable("chi2_value_"               , &chi2_value_               );
	mva_smh_varset8_m800->AddVariable("chi2_bjet_ptOverM_"        , &chi2_bjet_ptOverM_        );
	mva_smh_varset8_m800->AddVariable("chi2_bjet_eta_"            , &chi2_bjet_eta_            );
	mva_smh_varset8_m800->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva_smh_varset8_m800->AddVariable("chi2_wjet1_ptOverM_"       , &chi2_wjet1_ptOverM_       );
	mva_smh_varset8_m800->AddVariable("chi2_wjet1_eta_"           , &chi2_wjet1_eta_           );
	mva_smh_varset8_m800->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva_smh_varset8_m800->AddVariable("chi2_wjet2_ptOverM_"       , &chi2_wjet2_ptOverM_       );
	mva_smh_varset8_m800->AddVariable("chi2_wjet2_eta_"           , &chi2_wjet2_eta_           );
	mva_smh_varset8_m800->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );
	mva_smh_varset8_m800->AddVariable("chi2_wjets_deltaR_"        , &chi2_wjets_deltaR_        );
	mva_smh_varset8_m800->AddVariable("chi2_wboson_ptOverM_"      , &chi2_wboson_ptOverM_      );
	mva_smh_varset8_m800->AddVariable("chi2_wboson_eta_"          , &chi2_wboson_eta_          );
	mva_smh_varset8_m800->AddVariable("chi2_wboson_mass_"         , &chi2_wboson_mass_         );
	mva_smh_varset8_m800->AddVariable("chi2_wboson_deltaR_bjet_"  , &chi2_wboson_deltaR_bjet_  );
	mva_smh_varset8_m800->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva_smh_varset8_m800->AddVariable("chi2_tbw_ptOverM_"         , &chi2_tbw_ptOverM_         );
	mva_smh_varset8_m800->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva_smh_varset8_m800->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva_smh_varset8_m800->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva_smh_varset8_m800->AddVariable("tprime_pt_ratio_"          , &tprime_pt_ratio_          );
	mva_smh_varset8_m800->AddVariable("helicity_tprime_"          , &helicity_tprime_          );
    mva_smh_varset8_m800->BookMVA("BDT", "./mva/Hadronic_tprime_SMH_varSet8_sigM800_bdt.xml");
    //}}}
    // mva_smh_varset8_m900{{{
    mva_smh_varset8_m900.reset(new TMVA::Reader( "!Color:Silent" ));
	mva_smh_varset8_m900->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva_smh_varset8_m900->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva_smh_varset8_m900->AddVariable("max1_btag_"                , &max1_btag_                );
	mva_smh_varset8_m900->AddVariable("max2_btag_"                , &max2_btag_                );
	mva_smh_varset8_m900->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva_smh_varset8_m900->AddVariable("njets_"                    , &njets_                    );
	mva_smh_varset8_m900->AddVariable("nbjets_"                   , &nbjets_                   );
	mva_smh_varset8_m900->AddVariable("ht_"                       , &ht_                       );
	mva_smh_varset8_m900->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva_smh_varset8_m900->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva_smh_varset8_m900->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva_smh_varset8_m900->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva_smh_varset8_m900->AddVariable("jet1_ptOverM_"             , &jet1_ptOverM_             );
	mva_smh_varset8_m900->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva_smh_varset8_m900->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva_smh_varset8_m900->AddVariable("jet2_ptOverM_"             , &jet2_ptOverM_             );
	mva_smh_varset8_m900->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva_smh_varset8_m900->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva_smh_varset8_m900->AddVariable("jet3_ptOverM_"             , &jet3_ptOverM_             );
	mva_smh_varset8_m900->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva_smh_varset8_m900->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva_smh_varset8_m900->AddVariable("jet4_ptOverM_"             , &jet4_ptOverM_             );
	mva_smh_varset8_m900->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva_smh_varset8_m900->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva_smh_varset8_m900->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva_smh_varset8_m900->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva_smh_varset8_m900->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva_smh_varset8_m900->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva_smh_varset8_m900->AddVariable("met_"                      , &met_                      );
	mva_smh_varset8_m900->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva_smh_varset8_m900->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva_smh_varset8_m900->AddVariable("chi2_value_"               , &chi2_value_               );
	mva_smh_varset8_m900->AddVariable("chi2_bjet_ptOverM_"        , &chi2_bjet_ptOverM_        );
	mva_smh_varset8_m900->AddVariable("chi2_bjet_eta_"            , &chi2_bjet_eta_            );
	mva_smh_varset8_m900->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva_smh_varset8_m900->AddVariable("chi2_wjet1_ptOverM_"       , &chi2_wjet1_ptOverM_       );
	mva_smh_varset8_m900->AddVariable("chi2_wjet1_eta_"           , &chi2_wjet1_eta_           );
	mva_smh_varset8_m900->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva_smh_varset8_m900->AddVariable("chi2_wjet2_ptOverM_"       , &chi2_wjet2_ptOverM_       );
	mva_smh_varset8_m900->AddVariable("chi2_wjet2_eta_"           , &chi2_wjet2_eta_           );
	mva_smh_varset8_m900->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );
	mva_smh_varset8_m900->AddVariable("chi2_wjets_deltaR_"        , &chi2_wjets_deltaR_        );
	mva_smh_varset8_m900->AddVariable("chi2_wboson_ptOverM_"      , &chi2_wboson_ptOverM_      );
	mva_smh_varset8_m900->AddVariable("chi2_wboson_eta_"          , &chi2_wboson_eta_          );
	mva_smh_varset8_m900->AddVariable("chi2_wboson_mass_"         , &chi2_wboson_mass_         );
	mva_smh_varset8_m900->AddVariable("chi2_wboson_deltaR_bjet_"  , &chi2_wboson_deltaR_bjet_  );
	mva_smh_varset8_m900->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva_smh_varset8_m900->AddVariable("chi2_tbw_ptOverM_"         , &chi2_tbw_ptOverM_         );
	mva_smh_varset8_m900->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva_smh_varset8_m900->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva_smh_varset8_m900->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva_smh_varset8_m900->AddVariable("tprime_pt_ratio_"          , &tprime_pt_ratio_          );
	mva_smh_varset8_m900->AddVariable("helicity_tprime_"          , &helicity_tprime_          );
    mva_smh_varset8_m900->BookMVA("BDT", "./mva/Hadronic_tprime_SMH_varSet8_sigM900_bdt.xml");
    //}}}
    // mva_smh_varset8_m1000{{{
    mva_smh_varset8_m1000.reset(new TMVA::Reader( "!Color:Silent" ));
	mva_smh_varset8_m1000->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva_smh_varset8_m1000->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva_smh_varset8_m1000->AddVariable("max1_btag_"                , &max1_btag_                );
	mva_smh_varset8_m1000->AddVariable("max2_btag_"                , &max2_btag_                );
	mva_smh_varset8_m1000->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva_smh_varset8_m1000->AddVariable("njets_"                    , &njets_                    );
	mva_smh_varset8_m1000->AddVariable("nbjets_"                   , &nbjets_                   );
	mva_smh_varset8_m1000->AddVariable("ht_"                       , &ht_                       );
	mva_smh_varset8_m1000->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva_smh_varset8_m1000->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva_smh_varset8_m1000->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva_smh_varset8_m1000->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva_smh_varset8_m1000->AddVariable("jet1_ptOverM_"             , &jet1_ptOverM_             );
	mva_smh_varset8_m1000->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva_smh_varset8_m1000->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva_smh_varset8_m1000->AddVariable("jet2_ptOverM_"             , &jet2_ptOverM_             );
	mva_smh_varset8_m1000->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva_smh_varset8_m1000->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva_smh_varset8_m1000->AddVariable("jet3_ptOverM_"             , &jet3_ptOverM_             );
	mva_smh_varset8_m1000->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva_smh_varset8_m1000->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva_smh_varset8_m1000->AddVariable("jet4_ptOverM_"             , &jet4_ptOverM_             );
	mva_smh_varset8_m1000->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva_smh_varset8_m1000->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva_smh_varset8_m1000->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva_smh_varset8_m1000->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva_smh_varset8_m1000->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva_smh_varset8_m1000->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva_smh_varset8_m1000->AddVariable("met_"                      , &met_                      );
	mva_smh_varset8_m1000->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva_smh_varset8_m1000->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva_smh_varset8_m1000->AddVariable("chi2_value_"               , &chi2_value_               );
	mva_smh_varset8_m1000->AddVariable("chi2_bjet_ptOverM_"        , &chi2_bjet_ptOverM_        );
	mva_smh_varset8_m1000->AddVariable("chi2_bjet_eta_"            , &chi2_bjet_eta_            );
	mva_smh_varset8_m1000->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva_smh_varset8_m1000->AddVariable("chi2_wjet1_ptOverM_"       , &chi2_wjet1_ptOverM_       );
	mva_smh_varset8_m1000->AddVariable("chi2_wjet1_eta_"           , &chi2_wjet1_eta_           );
	mva_smh_varset8_m1000->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva_smh_varset8_m1000->AddVariable("chi2_wjet2_ptOverM_"       , &chi2_wjet2_ptOverM_       );
	mva_smh_varset8_m1000->AddVariable("chi2_wjet2_eta_"           , &chi2_wjet2_eta_           );
	mva_smh_varset8_m1000->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );
	mva_smh_varset8_m1000->AddVariable("chi2_wjets_deltaR_"        , &chi2_wjets_deltaR_        );
	mva_smh_varset8_m1000->AddVariable("chi2_wboson_ptOverM_"      , &chi2_wboson_ptOverM_      );
	mva_smh_varset8_m1000->AddVariable("chi2_wboson_eta_"          , &chi2_wboson_eta_          );
	mva_smh_varset8_m1000->AddVariable("chi2_wboson_mass_"         , &chi2_wboson_mass_         );
	mva_smh_varset8_m1000->AddVariable("chi2_wboson_deltaR_bjet_"  , &chi2_wboson_deltaR_bjet_  );
	mva_smh_varset8_m1000->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva_smh_varset8_m1000->AddVariable("chi2_tbw_ptOverM_"         , &chi2_tbw_ptOverM_         );
	mva_smh_varset8_m1000->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva_smh_varset8_m1000->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva_smh_varset8_m1000->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva_smh_varset8_m1000->AddVariable("tprime_pt_ratio_"          , &tprime_pt_ratio_          );
	mva_smh_varset8_m1000->AddVariable("helicity_tprime_"          , &helicity_tprime_          );
    mva_smh_varset8_m1000->BookMVA("BDT", "./mva/Hadronic_tprime_SMH_varSet8_sigM1000_bdt.xml");
    //}}}
    // mva_smh_varset8_m1100{{{
    mva_smh_varset8_m1100.reset(new TMVA::Reader( "!Color:Silent" ));
	mva_smh_varset8_m1100->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva_smh_varset8_m1100->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva_smh_varset8_m1100->AddVariable("max1_btag_"                , &max1_btag_                );
	mva_smh_varset8_m1100->AddVariable("max2_btag_"                , &max2_btag_                );
	mva_smh_varset8_m1100->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva_smh_varset8_m1100->AddVariable("njets_"                    , &njets_                    );
	mva_smh_varset8_m1100->AddVariable("nbjets_"                   , &nbjets_                   );
	mva_smh_varset8_m1100->AddVariable("ht_"                       , &ht_                       );
	mva_smh_varset8_m1100->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva_smh_varset8_m1100->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva_smh_varset8_m1100->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva_smh_varset8_m1100->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva_smh_varset8_m1100->AddVariable("jet1_ptOverM_"             , &jet1_ptOverM_             );
	mva_smh_varset8_m1100->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva_smh_varset8_m1100->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva_smh_varset8_m1100->AddVariable("jet2_ptOverM_"             , &jet2_ptOverM_             );
	mva_smh_varset8_m1100->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva_smh_varset8_m1100->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva_smh_varset8_m1100->AddVariable("jet3_ptOverM_"             , &jet3_ptOverM_             );
	mva_smh_varset8_m1100->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva_smh_varset8_m1100->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva_smh_varset8_m1100->AddVariable("jet4_ptOverM_"             , &jet4_ptOverM_             );
	mva_smh_varset8_m1100->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva_smh_varset8_m1100->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva_smh_varset8_m1100->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva_smh_varset8_m1100->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva_smh_varset8_m1100->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva_smh_varset8_m1100->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva_smh_varset8_m1100->AddVariable("met_"                      , &met_                      );
	mva_smh_varset8_m1100->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva_smh_varset8_m1100->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva_smh_varset8_m1100->AddVariable("chi2_value_"               , &chi2_value_               );
	mva_smh_varset8_m1100->AddVariable("chi2_bjet_ptOverM_"        , &chi2_bjet_ptOverM_        );
	mva_smh_varset8_m1100->AddVariable("chi2_bjet_eta_"            , &chi2_bjet_eta_            );
	mva_smh_varset8_m1100->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva_smh_varset8_m1100->AddVariable("chi2_wjet1_ptOverM_"       , &chi2_wjet1_ptOverM_       );
	mva_smh_varset8_m1100->AddVariable("chi2_wjet1_eta_"           , &chi2_wjet1_eta_           );
	mva_smh_varset8_m1100->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva_smh_varset8_m1100->AddVariable("chi2_wjet2_ptOverM_"       , &chi2_wjet2_ptOverM_       );
	mva_smh_varset8_m1100->AddVariable("chi2_wjet2_eta_"           , &chi2_wjet2_eta_           );
	mva_smh_varset8_m1100->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );
	mva_smh_varset8_m1100->AddVariable("chi2_wjets_deltaR_"        , &chi2_wjets_deltaR_        );
	mva_smh_varset8_m1100->AddVariable("chi2_wboson_ptOverM_"      , &chi2_wboson_ptOverM_      );
	mva_smh_varset8_m1100->AddVariable("chi2_wboson_eta_"          , &chi2_wboson_eta_          );
	mva_smh_varset8_m1100->AddVariable("chi2_wboson_mass_"         , &chi2_wboson_mass_         );
	mva_smh_varset8_m1100->AddVariable("chi2_wboson_deltaR_bjet_"  , &chi2_wboson_deltaR_bjet_  );
	mva_smh_varset8_m1100->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva_smh_varset8_m1100->AddVariable("chi2_tbw_ptOverM_"         , &chi2_tbw_ptOverM_         );
	mva_smh_varset8_m1100->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva_smh_varset8_m1100->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva_smh_varset8_m1100->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva_smh_varset8_m1100->AddVariable("tprime_pt_ratio_"          , &tprime_pt_ratio_          );
	mva_smh_varset8_m1100->AddVariable("helicity_tprime_"          , &helicity_tprime_          );
    mva_smh_varset8_m1100->BookMVA("BDT", "./mva/Hadronic_tprime_SMH_varSet8_sigM1100_bdt.xml");
    //}}}
    // mva_smh_varset8_m1200{{{
    mva_smh_varset8_m1200.reset(new TMVA::Reader( "!Color:Silent" ));
	mva_smh_varset8_m1200->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva_smh_varset8_m1200->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva_smh_varset8_m1200->AddVariable("max1_btag_"                , &max1_btag_                );
	mva_smh_varset8_m1200->AddVariable("max2_btag_"                , &max2_btag_                );
	mva_smh_varset8_m1200->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva_smh_varset8_m1200->AddVariable("njets_"                    , &njets_                    );
	mva_smh_varset8_m1200->AddVariable("nbjets_"                   , &nbjets_                   );
	mva_smh_varset8_m1200->AddVariable("ht_"                       , &ht_                       );
	mva_smh_varset8_m1200->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva_smh_varset8_m1200->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva_smh_varset8_m1200->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva_smh_varset8_m1200->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva_smh_varset8_m1200->AddVariable("jet1_ptOverM_"             , &jet1_ptOverM_             );
	mva_smh_varset8_m1200->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva_smh_varset8_m1200->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva_smh_varset8_m1200->AddVariable("jet2_ptOverM_"             , &jet2_ptOverM_             );
	mva_smh_varset8_m1200->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva_smh_varset8_m1200->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva_smh_varset8_m1200->AddVariable("jet3_ptOverM_"             , &jet3_ptOverM_             );
	mva_smh_varset8_m1200->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva_smh_varset8_m1200->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva_smh_varset8_m1200->AddVariable("jet4_ptOverM_"             , &jet4_ptOverM_             );
	mva_smh_varset8_m1200->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva_smh_varset8_m1200->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva_smh_varset8_m1200->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva_smh_varset8_m1200->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva_smh_varset8_m1200->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva_smh_varset8_m1200->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva_smh_varset8_m1200->AddVariable("met_"                      , &met_                      );
	mva_smh_varset8_m1200->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva_smh_varset8_m1200->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva_smh_varset8_m1200->AddVariable("chi2_value_"               , &chi2_value_               );
	mva_smh_varset8_m1200->AddVariable("chi2_bjet_ptOverM_"        , &chi2_bjet_ptOverM_        );
	mva_smh_varset8_m1200->AddVariable("chi2_bjet_eta_"            , &chi2_bjet_eta_            );
	mva_smh_varset8_m1200->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva_smh_varset8_m1200->AddVariable("chi2_wjet1_ptOverM_"       , &chi2_wjet1_ptOverM_       );
	mva_smh_varset8_m1200->AddVariable("chi2_wjet1_eta_"           , &chi2_wjet1_eta_           );
	mva_smh_varset8_m1200->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva_smh_varset8_m1200->AddVariable("chi2_wjet2_ptOverM_"       , &chi2_wjet2_ptOverM_       );
	mva_smh_varset8_m1200->AddVariable("chi2_wjet2_eta_"           , &chi2_wjet2_eta_           );
	mva_smh_varset8_m1200->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );
	mva_smh_varset8_m1200->AddVariable("chi2_wjets_deltaR_"        , &chi2_wjets_deltaR_        );
	mva_smh_varset8_m1200->AddVariable("chi2_wboson_ptOverM_"      , &chi2_wboson_ptOverM_      );
	mva_smh_varset8_m1200->AddVariable("chi2_wboson_eta_"          , &chi2_wboson_eta_          );
	mva_smh_varset8_m1200->AddVariable("chi2_wboson_mass_"         , &chi2_wboson_mass_         );
	mva_smh_varset8_m1200->AddVariable("chi2_wboson_deltaR_bjet_"  , &chi2_wboson_deltaR_bjet_  );
	mva_smh_varset8_m1200->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva_smh_varset8_m1200->AddVariable("chi2_tbw_ptOverM_"         , &chi2_tbw_ptOverM_         );
	mva_smh_varset8_m1200->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva_smh_varset8_m1200->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva_smh_varset8_m1200->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva_smh_varset8_m1200->AddVariable("tprime_pt_ratio_"          , &tprime_pt_ratio_          );
	mva_smh_varset8_m1200->AddVariable("helicity_tprime_"          , &helicity_tprime_          );
    mva_smh_varset8_m1200->BookMVA("BDT", "./mva/Hadronic_tprime_SMH_varSet8_sigM1200_bdt.xml");
    //}}}
    // mva_smh_varset8_mixed01{{{
    mva_smh_varset8_mixed01.reset(new TMVA::Reader( "!Color:Silent" ));
	mva_smh_varset8_mixed01->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva_smh_varset8_mixed01->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva_smh_varset8_mixed01->AddVariable("max1_btag_"                , &max1_btag_                );
	mva_smh_varset8_mixed01->AddVariable("max2_btag_"                , &max2_btag_                );
	mva_smh_varset8_mixed01->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva_smh_varset8_mixed01->AddVariable("njets_"                    , &njets_                    );
	mva_smh_varset8_mixed01->AddVariable("nbjets_"                   , &nbjets_                   );
	mva_smh_varset8_mixed01->AddVariable("ht_"                       , &ht_                       );
	mva_smh_varset8_mixed01->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva_smh_varset8_mixed01->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva_smh_varset8_mixed01->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva_smh_varset8_mixed01->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva_smh_varset8_mixed01->AddVariable("jet1_ptOverM_"             , &jet1_ptOverM_             );
	mva_smh_varset8_mixed01->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva_smh_varset8_mixed01->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva_smh_varset8_mixed01->AddVariable("jet2_ptOverM_"             , &jet2_ptOverM_             );
	mva_smh_varset8_mixed01->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva_smh_varset8_mixed01->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva_smh_varset8_mixed01->AddVariable("jet3_ptOverM_"             , &jet3_ptOverM_             );
	mva_smh_varset8_mixed01->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva_smh_varset8_mixed01->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva_smh_varset8_mixed01->AddVariable("jet4_ptOverM_"             , &jet4_ptOverM_             );
	mva_smh_varset8_mixed01->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva_smh_varset8_mixed01->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva_smh_varset8_mixed01->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva_smh_varset8_mixed01->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva_smh_varset8_mixed01->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva_smh_varset8_mixed01->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva_smh_varset8_mixed01->AddVariable("met_"                      , &met_                      );
	mva_smh_varset8_mixed01->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva_smh_varset8_mixed01->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva_smh_varset8_mixed01->AddVariable("chi2_value_"               , &chi2_value_               );
	mva_smh_varset8_mixed01->AddVariable("chi2_bjet_ptOverM_"        , &chi2_bjet_ptOverM_        );
	mva_smh_varset8_mixed01->AddVariable("chi2_bjet_eta_"            , &chi2_bjet_eta_            );
	mva_smh_varset8_mixed01->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva_smh_varset8_mixed01->AddVariable("chi2_wjet1_ptOverM_"       , &chi2_wjet1_ptOverM_       );
	mva_smh_varset8_mixed01->AddVariable("chi2_wjet1_eta_"           , &chi2_wjet1_eta_           );
	mva_smh_varset8_mixed01->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva_smh_varset8_mixed01->AddVariable("chi2_wjet2_ptOverM_"       , &chi2_wjet2_ptOverM_       );
	mva_smh_varset8_mixed01->AddVariable("chi2_wjet2_eta_"           , &chi2_wjet2_eta_           );
	mva_smh_varset8_mixed01->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );
	mva_smh_varset8_mixed01->AddVariable("chi2_wjets_deltaR_"        , &chi2_wjets_deltaR_        );
	mva_smh_varset8_mixed01->AddVariable("chi2_wboson_ptOverM_"      , &chi2_wboson_ptOverM_      );
	mva_smh_varset8_mixed01->AddVariable("chi2_wboson_eta_"          , &chi2_wboson_eta_          );
	mva_smh_varset8_mixed01->AddVariable("chi2_wboson_mass_"         , &chi2_wboson_mass_         );
	mva_smh_varset8_mixed01->AddVariable("chi2_wboson_deltaR_bjet_"  , &chi2_wboson_deltaR_bjet_  );
	mva_smh_varset8_mixed01->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva_smh_varset8_mixed01->AddVariable("chi2_tbw_ptOverM_"         , &chi2_tbw_ptOverM_         );
	mva_smh_varset8_mixed01->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva_smh_varset8_mixed01->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva_smh_varset8_mixed01->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva_smh_varset8_mixed01->AddVariable("tprime_pt_ratio_"          , &tprime_pt_ratio_          );
	mva_smh_varset8_mixed01->AddVariable("helicity_tprime_"          , &helicity_tprime_          );
    mva_smh_varset8_mixed01->BookMVA("BDT", "./mva/Hadronic_tprime_SMH_varSet8_sigMixed01_bdt.xml");
    //}}}
    // mva_smh_varset8_mixed02{{{
    mva_smh_varset8_mixed02.reset(new TMVA::Reader( "!Color:Silent" ));
	mva_smh_varset8_mixed02->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva_smh_varset8_mixed02->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva_smh_varset8_mixed02->AddVariable("max1_btag_"                , &max1_btag_                );
	mva_smh_varset8_mixed02->AddVariable("max2_btag_"                , &max2_btag_                );
	mva_smh_varset8_mixed02->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva_smh_varset8_mixed02->AddVariable("njets_"                    , &njets_                    );
	mva_smh_varset8_mixed02->AddVariable("nbjets_"                   , &nbjets_                   );
	mva_smh_varset8_mixed02->AddVariable("ht_"                       , &ht_                       );
	mva_smh_varset8_mixed02->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva_smh_varset8_mixed02->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva_smh_varset8_mixed02->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva_smh_varset8_mixed02->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva_smh_varset8_mixed02->AddVariable("jet1_ptOverM_"             , &jet1_ptOverM_             );
	mva_smh_varset8_mixed02->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva_smh_varset8_mixed02->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva_smh_varset8_mixed02->AddVariable("jet2_ptOverM_"             , &jet2_ptOverM_             );
	mva_smh_varset8_mixed02->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva_smh_varset8_mixed02->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva_smh_varset8_mixed02->AddVariable("jet3_ptOverM_"             , &jet3_ptOverM_             );
	mva_smh_varset8_mixed02->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva_smh_varset8_mixed02->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva_smh_varset8_mixed02->AddVariable("jet4_ptOverM_"             , &jet4_ptOverM_             );
	mva_smh_varset8_mixed02->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva_smh_varset8_mixed02->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva_smh_varset8_mixed02->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva_smh_varset8_mixed02->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva_smh_varset8_mixed02->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva_smh_varset8_mixed02->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva_smh_varset8_mixed02->AddVariable("met_"                      , &met_                      );
	mva_smh_varset8_mixed02->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva_smh_varset8_mixed02->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva_smh_varset8_mixed02->AddVariable("chi2_value_"               , &chi2_value_               );
	mva_smh_varset8_mixed02->AddVariable("chi2_bjet_ptOverM_"        , &chi2_bjet_ptOverM_        );
	mva_smh_varset8_mixed02->AddVariable("chi2_bjet_eta_"            , &chi2_bjet_eta_            );
	mva_smh_varset8_mixed02->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva_smh_varset8_mixed02->AddVariable("chi2_wjet1_ptOverM_"       , &chi2_wjet1_ptOverM_       );
	mva_smh_varset8_mixed02->AddVariable("chi2_wjet1_eta_"           , &chi2_wjet1_eta_           );
	mva_smh_varset8_mixed02->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva_smh_varset8_mixed02->AddVariable("chi2_wjet2_ptOverM_"       , &chi2_wjet2_ptOverM_       );
	mva_smh_varset8_mixed02->AddVariable("chi2_wjet2_eta_"           , &chi2_wjet2_eta_           );
	mva_smh_varset8_mixed02->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );
	mva_smh_varset8_mixed02->AddVariable("chi2_wjets_deltaR_"        , &chi2_wjets_deltaR_        );
	mva_smh_varset8_mixed02->AddVariable("chi2_wboson_ptOverM_"      , &chi2_wboson_ptOverM_      );
	mva_smh_varset8_mixed02->AddVariable("chi2_wboson_eta_"          , &chi2_wboson_eta_          );
	mva_smh_varset8_mixed02->AddVariable("chi2_wboson_mass_"         , &chi2_wboson_mass_         );
	mva_smh_varset8_mixed02->AddVariable("chi2_wboson_deltaR_bjet_"  , &chi2_wboson_deltaR_bjet_  );
	mva_smh_varset8_mixed02->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva_smh_varset8_mixed02->AddVariable("chi2_tbw_ptOverM_"         , &chi2_tbw_ptOverM_         );
	mva_smh_varset8_mixed02->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva_smh_varset8_mixed02->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva_smh_varset8_mixed02->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva_smh_varset8_mixed02->AddVariable("tprime_pt_ratio_"          , &tprime_pt_ratio_          );
	mva_smh_varset8_mixed02->AddVariable("helicity_tprime_"          , &helicity_tprime_          );
    mva_smh_varset8_mixed02->BookMVA("BDT", "./mva/Hadronic_tprime_SMH_varSet8_sigMixed02_bdt.xml");
    //}}}
    // mva_smh_varset8_mixed03{{{
    mva_smh_varset8_mixed03.reset(new TMVA::Reader( "!Color:Silent" ));
	mva_smh_varset8_mixed03->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva_smh_varset8_mixed03->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva_smh_varset8_mixed03->AddVariable("max1_btag_"                , &max1_btag_                );
	mva_smh_varset8_mixed03->AddVariable("max2_btag_"                , &max2_btag_                );
	mva_smh_varset8_mixed03->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva_smh_varset8_mixed03->AddVariable("njets_"                    , &njets_                    );
	mva_smh_varset8_mixed03->AddVariable("nbjets_"                   , &nbjets_                   );
	mva_smh_varset8_mixed03->AddVariable("ht_"                       , &ht_                       );
	mva_smh_varset8_mixed03->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva_smh_varset8_mixed03->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva_smh_varset8_mixed03->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva_smh_varset8_mixed03->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva_smh_varset8_mixed03->AddVariable("jet1_ptOverM_"             , &jet1_ptOverM_             );
	mva_smh_varset8_mixed03->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva_smh_varset8_mixed03->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva_smh_varset8_mixed03->AddVariable("jet2_ptOverM_"             , &jet2_ptOverM_             );
	mva_smh_varset8_mixed03->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva_smh_varset8_mixed03->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva_smh_varset8_mixed03->AddVariable("jet3_ptOverM_"             , &jet3_ptOverM_             );
	mva_smh_varset8_mixed03->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva_smh_varset8_mixed03->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva_smh_varset8_mixed03->AddVariable("jet4_ptOverM_"             , &jet4_ptOverM_             );
	mva_smh_varset8_mixed03->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva_smh_varset8_mixed03->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva_smh_varset8_mixed03->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva_smh_varset8_mixed03->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva_smh_varset8_mixed03->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva_smh_varset8_mixed03->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva_smh_varset8_mixed03->AddVariable("met_"                      , &met_                      );
	mva_smh_varset8_mixed03->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva_smh_varset8_mixed03->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva_smh_varset8_mixed03->AddVariable("chi2_value_"               , &chi2_value_               );
	mva_smh_varset8_mixed03->AddVariable("chi2_bjet_ptOverM_"        , &chi2_bjet_ptOverM_        );
	mva_smh_varset8_mixed03->AddVariable("chi2_bjet_eta_"            , &chi2_bjet_eta_            );
	mva_smh_varset8_mixed03->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva_smh_varset8_mixed03->AddVariable("chi2_wjet1_ptOverM_"       , &chi2_wjet1_ptOverM_       );
	mva_smh_varset8_mixed03->AddVariable("chi2_wjet1_eta_"           , &chi2_wjet1_eta_           );
	mva_smh_varset8_mixed03->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva_smh_varset8_mixed03->AddVariable("chi2_wjet2_ptOverM_"       , &chi2_wjet2_ptOverM_       );
	mva_smh_varset8_mixed03->AddVariable("chi2_wjet2_eta_"           , &chi2_wjet2_eta_           );
	mva_smh_varset8_mixed03->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );
	mva_smh_varset8_mixed03->AddVariable("chi2_wjets_deltaR_"        , &chi2_wjets_deltaR_        );
	mva_smh_varset8_mixed03->AddVariable("chi2_wboson_ptOverM_"      , &chi2_wboson_ptOverM_      );
	mva_smh_varset8_mixed03->AddVariable("chi2_wboson_eta_"          , &chi2_wboson_eta_          );
	mva_smh_varset8_mixed03->AddVariable("chi2_wboson_mass_"         , &chi2_wboson_mass_         );
	mva_smh_varset8_mixed03->AddVariable("chi2_wboson_deltaR_bjet_"  , &chi2_wboson_deltaR_bjet_  );
	mva_smh_varset8_mixed03->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva_smh_varset8_mixed03->AddVariable("chi2_tbw_ptOverM_"         , &chi2_tbw_ptOverM_         );
	mva_smh_varset8_mixed03->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva_smh_varset8_mixed03->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva_smh_varset8_mixed03->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva_smh_varset8_mixed03->AddVariable("tprime_pt_ratio_"          , &tprime_pt_ratio_          );
	mva_smh_varset8_mixed03->AddVariable("helicity_tprime_"          , &helicity_tprime_          );
    mva_smh_varset8_mixed03->BookMVA("BDT", "./mva/Hadronic_tprime_SMH_varSet8_sigMixed03_bdt.xml");
    //}}}
    // mva_smh_varset8_mixed04{{{
    mva_smh_varset8_mixed04.reset(new TMVA::Reader( "!Color:Silent" ));
	mva_smh_varset8_mixed04->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva_smh_varset8_mixed04->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva_smh_varset8_mixed04->AddVariable("max1_btag_"                , &max1_btag_                );
	mva_smh_varset8_mixed04->AddVariable("max2_btag_"                , &max2_btag_                );
	mva_smh_varset8_mixed04->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva_smh_varset8_mixed04->AddVariable("njets_"                    , &njets_                    );
	mva_smh_varset8_mixed04->AddVariable("nbjets_"                   , &nbjets_                   );
	mva_smh_varset8_mixed04->AddVariable("ht_"                       , &ht_                       );
	mva_smh_varset8_mixed04->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva_smh_varset8_mixed04->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva_smh_varset8_mixed04->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva_smh_varset8_mixed04->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva_smh_varset8_mixed04->AddVariable("jet1_ptOverM_"             , &jet1_ptOverM_             );
	mva_smh_varset8_mixed04->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva_smh_varset8_mixed04->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva_smh_varset8_mixed04->AddVariable("jet2_ptOverM_"             , &jet2_ptOverM_             );
	mva_smh_varset8_mixed04->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva_smh_varset8_mixed04->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva_smh_varset8_mixed04->AddVariable("jet3_ptOverM_"             , &jet3_ptOverM_             );
	mva_smh_varset8_mixed04->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva_smh_varset8_mixed04->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva_smh_varset8_mixed04->AddVariable("jet4_ptOverM_"             , &jet4_ptOverM_             );
	mva_smh_varset8_mixed04->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva_smh_varset8_mixed04->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva_smh_varset8_mixed04->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva_smh_varset8_mixed04->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva_smh_varset8_mixed04->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva_smh_varset8_mixed04->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva_smh_varset8_mixed04->AddVariable("met_"                      , &met_                      );
	mva_smh_varset8_mixed04->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva_smh_varset8_mixed04->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva_smh_varset8_mixed04->AddVariable("chi2_value_"               , &chi2_value_               );
	mva_smh_varset8_mixed04->AddVariable("chi2_bjet_ptOverM_"        , &chi2_bjet_ptOverM_        );
	mva_smh_varset8_mixed04->AddVariable("chi2_bjet_eta_"            , &chi2_bjet_eta_            );
	mva_smh_varset8_mixed04->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva_smh_varset8_mixed04->AddVariable("chi2_wjet1_ptOverM_"       , &chi2_wjet1_ptOverM_       );
	mva_smh_varset8_mixed04->AddVariable("chi2_wjet1_eta_"           , &chi2_wjet1_eta_           );
	mva_smh_varset8_mixed04->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva_smh_varset8_mixed04->AddVariable("chi2_wjet2_ptOverM_"       , &chi2_wjet2_ptOverM_       );
	mva_smh_varset8_mixed04->AddVariable("chi2_wjet2_eta_"           , &chi2_wjet2_eta_           );
	mva_smh_varset8_mixed04->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );
	mva_smh_varset8_mixed04->AddVariable("chi2_wjets_deltaR_"        , &chi2_wjets_deltaR_        );
	mva_smh_varset8_mixed04->AddVariable("chi2_wboson_ptOverM_"      , &chi2_wboson_ptOverM_      );
	mva_smh_varset8_mixed04->AddVariable("chi2_wboson_eta_"          , &chi2_wboson_eta_          );
	mva_smh_varset8_mixed04->AddVariable("chi2_wboson_mass_"         , &chi2_wboson_mass_         );
	mva_smh_varset8_mixed04->AddVariable("chi2_wboson_deltaR_bjet_"  , &chi2_wboson_deltaR_bjet_  );
	mva_smh_varset8_mixed04->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva_smh_varset8_mixed04->AddVariable("chi2_tbw_ptOverM_"         , &chi2_tbw_ptOverM_         );
	mva_smh_varset8_mixed04->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva_smh_varset8_mixed04->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva_smh_varset8_mixed04->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva_smh_varset8_mixed04->AddVariable("tprime_pt_ratio_"          , &tprime_pt_ratio_          );
	mva_smh_varset8_mixed04->AddVariable("helicity_tprime_"          , &helicity_tprime_          );
    mva_smh_varset8_mixed04->BookMVA("BDT", "./mva/Hadronic_tprime_SMH_varSet8_sigMixed04_bdt.xml");
    //}}}
    // mva_smh_varset8_mixed05{{{
    mva_smh_varset8_mixed05.reset(new TMVA::Reader( "!Color:Silent" ));
	mva_smh_varset8_mixed05->AddVariable("maxIDMVA_"                 , &maxIDMVA_                 );
	mva_smh_varset8_mixed05->AddVariable("minIDMVA_"                 , &minIDMVA_                 );
	mva_smh_varset8_mixed05->AddVariable("max1_btag_"                , &max1_btag_                );
	mva_smh_varset8_mixed05->AddVariable("max2_btag_"                , &max2_btag_                );
	mva_smh_varset8_mixed05->AddVariable("dipho_delta_R"             , &dipho_delta_R             );
	mva_smh_varset8_mixed05->AddVariable("njets_"                    , &njets_                    );
	mva_smh_varset8_mixed05->AddVariable("nbjets_"                   , &nbjets_                   );
	mva_smh_varset8_mixed05->AddVariable("ht_"                       , &ht_                       );
	mva_smh_varset8_mixed05->AddVariable("leadptoM_"                 , &leadptoM_                 );
	mva_smh_varset8_mixed05->AddVariable("subleadptoM_"              , &subleadptoM_              );
	mva_smh_varset8_mixed05->AddVariable("lead_eta_"                 , &lead_eta_                 );
	mva_smh_varset8_mixed05->AddVariable("sublead_eta_"              , &sublead_eta_              );
	mva_smh_varset8_mixed05->AddVariable("jet1_ptOverM_"             , &jet1_ptOverM_             );
	mva_smh_varset8_mixed05->AddVariable("jet1_eta_"                 , &jet1_eta_                 );
	mva_smh_varset8_mixed05->AddVariable("jet1_btag_"                , &jet1_btag_                );
	mva_smh_varset8_mixed05->AddVariable("jet2_ptOverM_"             , &jet2_ptOverM_             );
	mva_smh_varset8_mixed05->AddVariable("jet2_eta_"                 , &jet2_eta_                 );
	mva_smh_varset8_mixed05->AddVariable("jet2_btag_"                , &jet2_btag_                );
	mva_smh_varset8_mixed05->AddVariable("jet3_ptOverM_"             , &jet3_ptOverM_             );
	mva_smh_varset8_mixed05->AddVariable("jet3_eta_"                 , &jet3_eta_                 );
	mva_smh_varset8_mixed05->AddVariable("jet3_btag_"                , &jet3_btag_                );
	mva_smh_varset8_mixed05->AddVariable("jet4_ptOverM_"             , &jet4_ptOverM_             );
	mva_smh_varset8_mixed05->AddVariable("jet4_eta_"                 , &jet4_eta_                 );
	mva_smh_varset8_mixed05->AddVariable("jet4_btag_"                , &jet4_btag_                );
	mva_smh_varset8_mixed05->AddVariable("leadPSV_"                  , &leadPSV_                  );
	mva_smh_varset8_mixed05->AddVariable("subleadPSV_"               , &subleadPSV_               );
	mva_smh_varset8_mixed05->AddVariable("dipho_cosphi_"             , &dipho_cosphi_             );
	mva_smh_varset8_mixed05->AddVariable("dipho_rapidity_"           , &dipho_rapidity_           );
	mva_smh_varset8_mixed05->AddVariable("met_"                      , &met_                      );
	mva_smh_varset8_mixed05->AddVariable("dipho_pt_over_mass_"       , &dipho_pt_over_mass_       );
	mva_smh_varset8_mixed05->AddVariable("helicity_angle_"           , &helicity_angle_           );
	mva_smh_varset8_mixed05->AddVariable("chi2_value_"               , &chi2_value_               );
	mva_smh_varset8_mixed05->AddVariable("chi2_bjet_ptOverM_"        , &chi2_bjet_ptOverM_        );
	mva_smh_varset8_mixed05->AddVariable("chi2_bjet_eta_"            , &chi2_bjet_eta_            );
	mva_smh_varset8_mixed05->AddVariable("chi2_bjet_btagScores_"     , &chi2_bjet_btagScores_     );
	mva_smh_varset8_mixed05->AddVariable("chi2_wjet1_ptOverM_"       , &chi2_wjet1_ptOverM_       );
	mva_smh_varset8_mixed05->AddVariable("chi2_wjet1_eta_"           , &chi2_wjet1_eta_           );
	mva_smh_varset8_mixed05->AddVariable("chi2_wjet1_btagScores_"    , &chi2_wjet1_btagScores_    );
	mva_smh_varset8_mixed05->AddVariable("chi2_wjet2_ptOverM_"       , &chi2_wjet2_ptOverM_       );
	mva_smh_varset8_mixed05->AddVariable("chi2_wjet2_eta_"           , &chi2_wjet2_eta_           );
	mva_smh_varset8_mixed05->AddVariable("chi2_wjet2_btagScores_"    , &chi2_wjet2_btagScores_    );
	mva_smh_varset8_mixed05->AddVariable("chi2_wjets_deltaR_"        , &chi2_wjets_deltaR_        );
	mva_smh_varset8_mixed05->AddVariable("chi2_wboson_ptOverM_"      , &chi2_wboson_ptOverM_      );
	mva_smh_varset8_mixed05->AddVariable("chi2_wboson_eta_"          , &chi2_wboson_eta_          );
	mva_smh_varset8_mixed05->AddVariable("chi2_wboson_mass_"         , &chi2_wboson_mass_         );
	mva_smh_varset8_mixed05->AddVariable("chi2_wboson_deltaR_bjet_"  , &chi2_wboson_deltaR_bjet_  );
	mva_smh_varset8_mixed05->AddVariable("chi2_tbw_mass_"            , &chi2_tbw_mass_            );
	mva_smh_varset8_mixed05->AddVariable("chi2_tbw_ptOverM_"         , &chi2_tbw_ptOverM_         );
	mva_smh_varset8_mixed05->AddVariable("chi2_tbw_eta_"             , &chi2_tbw_eta_             );
	mva_smh_varset8_mixed05->AddVariable("chi2_tprime_ptOverM_"      , &chi2_tprime_ptOverM_      );
	mva_smh_varset8_mixed05->AddVariable("chi2_tprime_eta_"          , &chi2_tprime_eta_          );
	mva_smh_varset8_mixed05->AddVariable("tprime_pt_ratio_"          , &tprime_pt_ratio_          );
	mva_smh_varset8_mixed05->AddVariable("helicity_tprime_"          , &helicity_tprime_          );
    mva_smh_varset8_mixed05->BookMVA("BDT", "./mva/Hadronic_tprime_SMH_varSet8_sigMixed05_bdt.xml");
    //}}}
  }

  // File Loop
  while ( (currentFile = (TFile*)fileIter.Next()) ) {
    // Get File Content
    TFile file(currentFile->GetTitle());
    TTree *tree = (TTree*)file.Get("tagsDumper/trees/tHq_13TeV_THQHadronicTag");

    if (fast) TTreeCache::SetLearnEntries(10);
    if (fast) tree->SetCacheSize(128*1024*1024);
    analyzer.Init(tree);

    // Loop over Events in current file
    if (nEventsTotal >= nEventsChain) continue;
    unsigned int nEventsTree = tree->GetEntriesFast();
    for (unsigned int event = 0; event < nEventsTree; ++event)
    {
      //if( (event+1) % 100 == 0) printf("ievent = %d / %d\n", event, nEventsTree);
      bool debug = false;
      bool debug_deeper = false;
      
      // Get Event Content
      if (nEventsTotal >= nEventsChain) continue;
      if (fast) tree->LoadTree(event);
      analyzer.GetEntry(event);
      ++nEventsTotal;

      // Progress
      tprimetHHadronic::progress( nEventsTotal, nEventsChain );

      // Jets
      vector<double> btag_scores;
      vector<TLorentzVector> jets = make_jets(btag_scores);
      vector< std::pair<int, double> > btag_scores_sorted = sortVectorGreater(btag_scores);
      if(jets.size() < 3) continue;

      // Di-Photon
      TLorentzVector diphoton, lead_photon, sublead_photon;
      diphoton.SetPtEtaPhiE(dipho_pt(), dipho_eta(), dipho_phi(), dipho_e());
      lead_photon.SetPtEtaPhiM(dipho_leadPt(), dipho_leadEta(), dipho_leadPhi(), 0.);
      sublead_photon.SetPtEtaPhiM(dipho_subleadPt(), dipho_subleadEta(), dipho_subleadPhi(), 0.);
      TLorentzVector diphoton_v2 = lead_photon + sublead_photon;
      
      //------------------------------ Variable definitions ------------------------------//
      maxIDMVA_ = dipho_leadIDMVA() >  dipho_subleadIDMVA() ? dipho_leadIDMVA() : dipho_subleadIDMVA();
      minIDMVA_ = dipho_leadIDMVA() <= dipho_subleadIDMVA() ? dipho_leadIDMVA() : dipho_subleadIDMVA();

      ht_            = get_ht(jets);

      njets_ = n_jets();
      nbjets_ = n_M_bjets();
      max1_btag_ = btag_scores_sorted[0].second;
      max2_btag_ = btag_scores_sorted[1].second;
      jet1_pt_   = njets_ >= 1 ? jets[0].Pt()   : -999;
      jet1_eta_  = njets_ >= 1 ? jets[0].Eta()  : -999;
      jet1_btag_ = njets_ >= 1 ? btag_scores[0] : -999;
      jet2_pt_   = njets_ >= 2 ? jets[1].Pt()   : -999; 
      jet2_eta_  = njets_ >= 2 ? jets[1].Eta()  : -999;
      jet2_btag_ = njets_ >= 2 ? btag_scores[1] : -999;
      jet3_pt_   = njets_ >= 3 ? jets[2].Pt()   : -999;
      jet3_eta_  = njets_ >= 3 ? jets[2].Eta()  : -999;
      jet3_btag_ = njets_ >= 3 ? btag_scores[2] : -999;
      jet4_pt_   = njets_ >= 4 ? jets[3].Pt()   : -999;
      jet4_eta_  = njets_ >= 4 ? jets[3].Eta()  : -999;
      jet4_btag_ = njets_ >= 4 ? btag_scores[3] : -999;

      // photons, diphoton, helicity angle, top masses
      dipho_delta_R  = lead_photon.DeltaR(sublead_photon);
      leadptoM_     = dipho_lead_ptoM();
      subleadptoM_  = dipho_sublead_ptoM();
      lead_eta_     = dipho_leadEta();
      sublead_eta_  = dipho_subleadEta();

      leadPSV_ = dipho_lead_haspixelseed();
      subleadPSV_ = dipho_sublead_haspixelseed();

      dipho_cosphi_ = dipho_cosphi();
      dipho_pt_over_mass_ = diphoton.Pt() / diphoton.M();
      met_ = recoMET_pt();

      dipho_rapidity_ = diphoton.Rapidity(); //dipho_rapidity();
      helicity_angle_ = helicity(lead_photon, sublead_photon);


      //------------------------------ Minimum chi-2 method (cov.) ------------------------------//
      double min_chi2_value_2x2 = 99999.;
      vector<int> indices_bjj_covMatrix(3, -1);
      bool has_resonable_reco = get_the_best_bjj_candidate(indices_bjj_covMatrix, jets, diphoton, btag_scores, min_chi2_value_2x2, json_file);

      TLorentzVector null;
      TLorentzVector cov_bjet  = has_resonable_reco ? jets[indices_bjj_covMatrix[0]] : null;
      TLorentzVector cov_wjet1 = has_resonable_reco ? jets[indices_bjj_covMatrix[1]] : null;
      TLorentzVector cov_wjet2 = has_resonable_reco ? jets[indices_bjj_covMatrix[2]] : null;
      TLorentzVector cov_wboson = cov_wjet1 + cov_wjet2;
      TLorentzVector cov_top = cov_bjet + cov_wboson;
      TLorentzVector cov_tprime = cov_top + diphoton;

      bool pass_eta_criteria_on_wjets = ( cov_wjet1.Eta() < 3. && cov_wjet2.Eta() < 3. );
      if( !pass_eta_criteria_on_wjets ) continue;

      double mass_wboson = has_resonable_reco ? cov_wboson.M()     : -1.;
      double mass_top    = has_resonable_reco ? cov_top.M()        : -1.;
      double mass_tprime = has_resonable_reco ? cov_tprime.M()     : -1.;
      double mass_tprime_tilde = has_resonable_reco ? ( cov_tprime.M() - cov_top.M() - diphoton.M() + 175.5 + 125.0 ) : -1.;
      min_chi2_value_2x2 = has_resonable_reco ? min_chi2_value_2x2 : -1.;

      chi2_value_               = min_chi2_value_2x2;
      chi2_bjet_pt_             = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_bjet.Pt()                         : -999;
      chi2_wjet1_pt_            = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_wjet1.Pt()                        : -999;
      chi2_wjet2_pt_            = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_wjet2.Pt()                        : -999;
      chi2_bjet_eta_            = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_bjet.Eta()                        : -999;
      chi2_wjet1_eta_           = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_wjet1.Eta()                       : -999;
      chi2_wjet2_eta_           = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_wjet2.Eta()                       : -999;
      chi2_wjets_deltaR_        = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_wjet1.DeltaR(cov_wjet2)           : -999;
      chi2_wboson_pt_           = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_wboson.Pt()                       : -999;
      chi2_wboson_eta_          = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_wboson.Eta()                      : -999;
      chi2_wboson_mass_         = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_wboson.M()                        : -999;
      chi2_wboson_deltaR_bjet_  = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_wboson.DeltaR(cov_bjet)           : -999;
      chi2_tbw_mass_            = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_top.M()                           : -999;
      chi2_tbw_pt_              = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_top.Pt()                          : -999;
      chi2_tbw_eta_             = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_top.Eta()                         : -999;
      chi2_tbw_deltaR_dipho_    = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_top.DeltaR(diphoton)              : -999;
      chi2_tprime_ptOverM_      = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_tprime.Pt()/cov_tprime.M()        : -999;
      chi2_tprime_eta_          = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_tprime.Eta()                      : -999;
      chi2_tprime_deltaR_tbw_   = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_tprime.DeltaR(cov_top)            : -999;
      chi2_tprime_deltaR_dipho_ = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_tprime.DeltaR(diphoton)           : -999;
      chi2_bjet_btagScores_     = (has_resonable_reco && pass_eta_criteria_on_wjets) ? btag_scores[indices_bjj_covMatrix[0]] : -999;
      chi2_wjet1_btagScores_    = (has_resonable_reco && pass_eta_criteria_on_wjets) ? btag_scores[indices_bjj_covMatrix[1]] : -999;
      chi2_wjet2_btagScores_    = (has_resonable_reco && pass_eta_criteria_on_wjets) ? btag_scores[indices_bjj_covMatrix[2]] : -999;
      tprime_pt_ratio_          = (has_resonable_reco && pass_eta_criteria_on_wjets) ? (cov_top.Pt() + dipho_pt())/ ht_      : -999;
  
      chi2_bjet_ptOverM_        = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_bjet.Pt() / cov_top.M()           : -999;
      chi2_wjet1_ptOverM_       = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_wjet1.Pt() / cov_wboson.M()       : -999;
      chi2_wjet2_ptOverM_       = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_wjet2.Pt() / cov_wboson.M()       : -999;
      chi2_wboson_ptOverM_      = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_wboson.Pt() / cov_wboson.M()      : -999;
      chi2_tbw_ptOverM_         = (has_resonable_reco && pass_eta_criteria_on_wjets) ? cov_top.Pt() / cov_top.M()            : -999;
      helicity_tprime_          = (has_resonable_reco && pass_eta_criteria_on_wjets) ? helicity(cov_tprime, diphoton)        : -999;
 
      jet1_ptOverM_ = (njets_ >= 1 && (has_resonable_reco && pass_eta_criteria_on_wjets)) ? jets[0].Pt() / cov_top.M()  : -999;
      jet2_ptOverM_ = (njets_ >= 2 && (has_resonable_reco && pass_eta_criteria_on_wjets)) ? jets[1].Pt() / cov_top.M()  : -999; 
      jet3_ptOverM_ = (njets_ >= 3 && (has_resonable_reco && pass_eta_criteria_on_wjets)) ? jets[2].Pt() / cov_top.M()  : -999;
      jet4_ptOverM_ = (njets_ >= 4 && (has_resonable_reco && pass_eta_criteria_on_wjets)) ? jets[3].Pt() / cov_top.M()  : -999;

      //------------------------------ MVA value & selection cut ------------------------------//
      double mva_value                     = -999;
      double mva_value_nrb_m600            = -999;
      double mva_value_smh_m600            = -999;
      double mva_value_smhnrb_m600         = -999;
      double mva_value_smh_varset8_m600    = -999;
      double mva_value_smh_varset8_m625    = -999;
      double mva_value_smh_varset8_m650    = -999;
      double mva_value_smh_varset8_m675    = -999;
      double mva_value_smh_varset8_m700    = -999;
      double mva_value_smh_varset8_m800    = -999;
      double mva_value_smh_varset8_m900    = -999;
      double mva_value_smh_varset8_m1000   = -999;
      double mva_value_smh_varset8_m1100   = -999;
      double mva_value_smh_varset8_m1200   = -999;
      double mva_value_smh_varset8_mixed01 = -999;
      double mva_value_smh_varset8_mixed02 = -999;
      double mva_value_smh_varset8_mixed03 = -999;
      double mva_value_smh_varset8_mixed04 = -999;
      double mva_value_smh_varset8_mixed05 = -999;

      if (evaluate_mva) mva_value                     = convert_tmva_to_prob(mva->EvaluateMVA( "BDT" ));
      if (evaluate_mva) mva_value_nrb_m600            = convert_tmva_to_prob(mva_nrb_m600->EvaluateMVA( "BDT" ));
      if (evaluate_mva) mva_value_smh_m600            = convert_tmva_to_prob(mva_smh_m600->EvaluateMVA( "BDT" ));
      if (evaluate_mva) mva_value_smhnrb_m600         = convert_tmva_to_prob(mva_smhnrb_m600->EvaluateMVA( "BDT" ));
      if (evaluate_mva) mva_value_smh_varset8_m600    = convert_tmva_to_prob(mva_smh_varset8_m600->EvaluateMVA( "BDT" ));
      if (evaluate_mva) mva_value_smh_varset8_m625    = convert_tmva_to_prob(mva_smh_varset8_m625->EvaluateMVA( "BDT" ));
      if (evaluate_mva) mva_value_smh_varset8_m650    = convert_tmva_to_prob(mva_smh_varset8_m650->EvaluateMVA( "BDT" ));
      if (evaluate_mva) mva_value_smh_varset8_m675    = convert_tmva_to_prob(mva_smh_varset8_m675->EvaluateMVA( "BDT" ));
      if (evaluate_mva) mva_value_smh_varset8_m700    = convert_tmva_to_prob(mva_smh_varset8_m700->EvaluateMVA( "BDT" ));
      if (evaluate_mva) mva_value_smh_varset8_m800    = convert_tmva_to_prob(mva_smh_varset8_m800->EvaluateMVA( "BDT" ));
      if (evaluate_mva) mva_value_smh_varset8_m900    = convert_tmva_to_prob(mva_smh_varset8_m900->EvaluateMVA( "BDT" ));
      if (evaluate_mva) mva_value_smh_varset8_m1000   = convert_tmva_to_prob(mva_smh_varset8_m1000->EvaluateMVA( "BDT" ));
      if (evaluate_mva) mva_value_smh_varset8_m1100   = convert_tmva_to_prob(mva_smh_varset8_m1100->EvaluateMVA( "BDT" ));
      if (evaluate_mva) mva_value_smh_varset8_m1200   = convert_tmva_to_prob(mva_smh_varset8_m1200->EvaluateMVA( "BDT" ));
      if (evaluate_mva) mva_value_smh_varset8_mixed01 = convert_tmva_to_prob(mva_smh_varset8_mixed01->EvaluateMVA( "BDT" ));
      if (evaluate_mva) mva_value_smh_varset8_mixed02 = convert_tmva_to_prob(mva_smh_varset8_mixed02->EvaluateMVA( "BDT" ));
      if (evaluate_mva) mva_value_smh_varset8_mixed03 = convert_tmva_to_prob(mva_smh_varset8_mixed03->EvaluateMVA( "BDT" ));
      if (evaluate_mva) mva_value_smh_varset8_mixed04 = convert_tmva_to_prob(mva_smh_varset8_mixed04->EvaluateMVA( "BDT" ));
      if (evaluate_mva) mva_value_smh_varset8_mixed05 = convert_tmva_to_prob(mva_smh_varset8_mixed05->EvaluateMVA( "BDT" ));

      int mvaCategoryId = mva_value < -0.8 ? 0 : 1;
      //if (!passes_selection(tag, minIDMVA_, maxIDMVA_, mva_value))	continue;
      if (!passes_selection("ttHHadronic_RunII_MVA_Presel", minIDMVA_, maxIDMVA_, -999.))	continue;


      float evt_weight = weight();
      int genLeptonId = 0; // isData ? -1 : categorize_leptons(nGoodEls(), nGoodMus()); // none of reco lepton exists
      int genPhotonId = 2; // isData ? -1 : categorize_photons(leadGenMatch(), subleadGenMatch()); // no effect for signal samples
      int genPhotonDetailId = 5; // isData ? -1 : categorize_photons_detail(lead_photon_type(), sublead_photon_type()); // assume prompt-prompt
      int photonLocationId = categorize_photon_locations(dipho_leadEta(), dipho_subleadEta());
      int yearId = mYear == "2016" ? 0 : (mYear == "2017" ? 1 : (mYear == "2018" ? 2 : -1));
      int processId = categorize_process(currentFileTitle, genPhotonId);
      vector<int> vId = {genLeptonId, genPhotonId, genPhotonDetailId, photonLocationId, mvaCategoryId, -1, yearId};


      //------------------------------ Fill histograms ------------------------------//
      TString syst_ext = "";
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_transf"                         , -log(1 - mva_value)           , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_n15"                      , mva_value                     , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_n30"                      , mva_value                     , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_n100"                     , mva_value                     , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_nrb_m600_n30"             , mva_value_nrb_m600            , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_nrb_m600_n100"            , mva_value_nrb_m600            , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_m600_n30"             , mva_value_smh_m600            , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_m600_n100"            , mva_value_smh_m600            , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smhnrb_m600_n30"          , mva_value_smhnrb_m600         , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smhnrb_m600_n100"         , mva_value_smhnrb_m600         , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m600_n30"     , mva_value_smh_varset8_m600    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m600_n100"    , mva_value_smh_varset8_m600    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m625_n30"     , mva_value_smh_varset8_m625    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m625_n100"    , mva_value_smh_varset8_m625    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m650_n30"     , mva_value_smh_varset8_m650    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m650_n100"    , mva_value_smh_varset8_m650    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m675_n30"     , mva_value_smh_varset8_m675    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m675_n100"    , mva_value_smh_varset8_m675    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m700_n30"     , mva_value_smh_varset8_m700    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m700_n100"    , mva_value_smh_varset8_m700    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m800_n30"     , mva_value_smh_varset8_m800    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m800_n100"    , mva_value_smh_varset8_m800    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m900_n30"     , mva_value_smh_varset8_m900    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m900_n100"    , mva_value_smh_varset8_m900    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m1000_n30"    , mva_value_smh_varset8_m1000   , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m1000_n100"   , mva_value_smh_varset8_m1000   , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m1100_n30"    , mva_value_smh_varset8_m1100   , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m1100_n100"   , mva_value_smh_varset8_m1100   , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m1200_n30"    , mva_value_smh_varset8_m1200   , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_m1200_n100"   , mva_value_smh_varset8_m1200   , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_mixed01_n30"  , mva_value_smh_varset8_mixed01 , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_mixed01_n100" , mva_value_smh_varset8_mixed01 , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_mixed02_n30"  , mva_value_smh_varset8_mixed02 , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_mixed02_n100" , mva_value_smh_varset8_mixed02 , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_mixed03_n30"  , mva_value_smh_varset8_mixed03 , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_mixed03_n100" , mva_value_smh_varset8_mixed03 , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_mixed04_n30"  , mva_value_smh_varset8_mixed04 , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_mixed04_n100" , mva_value_smh_varset8_mixed04 , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_mixed05_n30"  , mva_value_smh_varset8_mixed05 , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "MVA_value_smh_varset8_mixed05_n100" , mva_value_smh_varset8_mixed05 , evt_weight , vId);

      vProcess[processId]->fill_histogram("h" + syst_ext + "Mass"               , diphoton.M()                       , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "PtHiggs"            , diphoton.Pt()                      , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "DiphotonPtOverMass" , diphoton.Pt() / diphoton.M()       , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "PhotonDeltaR"       , lead_photon.DeltaR(sublead_photon) , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "Rapidity"           , diphoton.Rapidity()                , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "AbsCosHelicity"     , helicity_angle_, evt_weight, vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "DiphotonCosPhi"     , dipho_cosphi(), evt_weight, vId);


      vProcess[processId]->fill_histogram("h" + syst_ext + "mass_wboson_cov"   , mass_wboson        , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "mass_top_cov"      , mass_top           , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "mass_tprime_cov"   , mass_tprime        , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "mass_tprime_tilde" , mass_tprime_tilde  , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "cov_chi2_value"    , min_chi2_value_2x2 , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_bjet_pt"             , chi2_bjet_pt_             , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_wjet1_pt"            , chi2_wjet1_pt_            , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_wjet2_pt"            , chi2_wjet2_pt_            , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_bjet_eta"            , chi2_bjet_eta_            , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_wjet1_eta"           , chi2_wjet1_eta_           , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_wjet2_eta"           , chi2_wjet2_eta_           , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_wjets_deltaR"        , chi2_wjets_deltaR_        , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_wboson_pt"           , chi2_wboson_pt_           , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_wboson_eta"          , chi2_wboson_eta_          , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_wboson_mass"         , chi2_wboson_mass_         , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_wboson_deltaR_bjet"  , chi2_wboson_deltaR_bjet_  , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_tbw_mass"            , chi2_tbw_mass_            , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_tbw_pt"              , chi2_tbw_pt_              , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_tbw_eta"             , chi2_tbw_eta_             , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_tbw_deltaR_dipho"    , chi2_tbw_deltaR_dipho_    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_tprime_ptOverM"      , chi2_tprime_ptOverM_      , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_tprime_eta"          , chi2_tprime_eta_          , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_tprime_deltaR_tbw"   , chi2_tprime_deltaR_tbw_   , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_tprime_deltaR_dipho" , chi2_tprime_deltaR_dipho_ , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_bjet_btagScores"     , chi2_bjet_btagScores_     , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_wjet1_btagScores"    , chi2_wjet1_btagScores_    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_wjet2_btagScores"    , chi2_wjet2_btagScores_    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "tprime_pt_ratio"          , tprime_pt_ratio_          , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_bjet_ptOverM"        , chi2_bjet_ptOverM_        , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_wjet1_ptOverM"       , chi2_wjet1_ptOverM_       , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_wjet2_ptOverM"       , chi2_wjet2_ptOverM_       , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_wboson_ptOverM"      , chi2_wboson_ptOverM_      , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "chi2_tbw_ptOverM"         , chi2_tbw_ptOverM_         , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "helicity_tprime"          , helicity_tprime_          , evt_weight , vId);

      vProcess[processId]->fill_histogram("h" + syst_ext + "PhotonLeadPt"       , dipho_leadPt()       , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "PhotonLeadEta"      , dipho_leadEta()      , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "PhotonLeadPhi"      , dipho_leadPhi()      , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "PhotonLeadIDMVA"    , dipho_leadIDMVA()    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "PhotonLeadPToM"     , dipho_lead_ptoM()    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "PhotonSubleadPt"    , dipho_subleadPt()    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "PhotonSubleadEta"   , dipho_subleadEta()   , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "PhotonSubleadPhi"   , dipho_subleadPhi()   , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "PhotonSubleadIDMVA" , dipho_subleadIDMVA() , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "PhotonSubleadPToM"  , dipho_sublead_ptoM() , evt_weight , vId);

      vProcess[processId]->fill_histogram("h" + syst_ext + "NJets"    , n_jets()    , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "NbLoose"  , n_L_bjets() , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "NbMedium" , n_M_bjets() , evt_weight , vId);
      vProcess[processId]->fill_histogram("h" + syst_ext + "NbTight"  , n_T_bjets() , evt_weight , vId);

      if (jet1_pt() >= 0) vProcess[processId]->fill_histogram("h" + syst_ext + "Jet1pT"       , jet1_pt()     , evt_weight , vId);
      if (jet2_pt() >= 0) vProcess[processId]->fill_histogram("h" + syst_ext + "Jet2pT"       , jet2_pt()     , evt_weight , vId);
      if (jet3_pt() >= 0) vProcess[processId]->fill_histogram("h" + syst_ext + "Jet3pT"       , jet3_pt()     , evt_weight , vId);
      if (jet4_pt() >= 0) vProcess[processId]->fill_histogram("h" + syst_ext + "Jet4pT"       , jet4_pt()     , evt_weight , vId);
      if (jet1_pt() >= 0) vProcess[processId]->fill_histogram("h" + syst_ext + "Jet1Eta"      , jet1_eta()    , evt_weight , vId);
      if (jet2_pt() >= 0) vProcess[processId]->fill_histogram("h" + syst_ext + "Jet2Eta"      , jet2_eta()    , evt_weight , vId);
      if (jet3_pt() >= 0) vProcess[processId]->fill_histogram("h" + syst_ext + "Jet3Eta"      , jet3_eta()    , evt_weight , vId);
      if (jet4_pt() >= 0) vProcess[processId]->fill_histogram("h" + syst_ext + "Jet4Eta"      , jet4_eta()    , evt_weight , vId);
      if (jet1_pt() >= 0) vProcess[processId]->fill_histogram("h" + syst_ext + "Jet1BTag"     , jet1_discr()  , evt_weight , vId);
      if (jet2_pt() >= 0) vProcess[processId]->fill_histogram("h" + syst_ext + "Jet2BTag"     , jet2_discr()  , evt_weight , vId);
      if (jet3_pt() >= 0) vProcess[processId]->fill_histogram("h" + syst_ext + "Jet3BTag"     , jet3_discr()  , evt_weight , vId);
      if (jet4_pt() >= 0) vProcess[processId]->fill_histogram("h" + syst_ext + "Jet4BTag"     , jet4_discr()  , evt_weight , vId);
      if (jet1_pt() >= 0) vProcess[processId]->fill_histogram("h" + syst_ext + "jet1_ptOverM" , jet1_ptOverM_ , evt_weight , vId);
      if (jet2_pt() >= 0) vProcess[processId]->fill_histogram("h" + syst_ext + "jet2_ptOverM" , jet2_ptOverM_ , evt_weight , vId);
      if (jet3_pt() >= 0) vProcess[processId]->fill_histogram("h" + syst_ext + "jet3_ptOverM" , jet3_ptOverM_ , evt_weight , vId);
      if (jet4_pt() >= 0) vProcess[processId]->fill_histogram("h" + syst_ext + "jet4_ptOverM" , jet4_ptOverM_ , evt_weight , vId);

    } // end of event loop

    // Clean Up
    delete tree;
    file.Close();
  }
  if (nEventsChain != nEventsTotal) {
    cout << Form( "ERROR: number of events from files (%d) is not equal to total number of events (%d)", nEventsChain, nEventsTotal ) << endl;
  }
  
  // Example Histograms
  output_file->cd();
  output_file->Write();
  output_file->Close();
  
  // return
  bmark->Stop("benchmark");
  cout << endl;
  cout << nEventsTotal << " Events Processed" << endl;
  cout << "------------------------------" << endl;
  cout << "CPU  Time: " << Form( "%.01f", bmark->GetCpuTime("benchmark")  ) << endl;
  cout << "Real Time: " << Form( "%.01f", bmark->GetRealTime("benchmark") ) << endl;
  cout << endl;
  delete bmark;
  return 0;
}
